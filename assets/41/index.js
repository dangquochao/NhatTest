window.__require=function t(e,n,i){function o(a,s){if(!n[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(t){return o(e[a][1][t]||t)},h,h.exports,t,e,n,i)}return n[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<i.length;a++)o(i[a]);return o}({"Baccarat.Assets":[function(t,e,n){"use strict";cc._RF.push(e,"c3929B7DJJFJ56uustrPN2z","Baccarat.Assets");var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../Scritps/Windown"),s=cc._decorator,c=s.ccclass,l=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chipBetTemp=null,e.effectWin=null,e.chipBetSprites=[],e.listBetValue=[1,5,10,50,100,500,1e3,2e3,5e3,1e4,5e4,1e5,15e4,2e5],e.chipBetPool=null,e.cardAtlas=null,e.spriteCard=[],e}return o(e,t),e.prototype.onLoad=function(){this.chipBetPool=new cc.NodePool("chipbet");for(var t=39;t<52;t++)this.spriteCard.push(this.cardAtlas.getSpriteFrame(t+""));for(t=26;t<39;t++)this.spriteCard.push(this.cardAtlas.getSpriteFrame(t+""));for(t=0;t<13;t++)this.spriteCard.push(this.cardAtlas.getSpriteFrame(t+""));for(t=13;t<26;t++)this.spriteCard.push(this.cardAtlas.getSpriteFrame(t+""))},e.prototype.start=function(){},e.prototype.getCardSprite=function(t){return this.spriteCard[t-1]},e.prototype.getCardBack=function(){return this.cardAtlas.getSpriteFrame("52")},e.prototype.getEffectWin=function(t){var e=cc.instantiate(this.effectWin.node);return e.getChildByName("lbChipWin").getComponent(cc.Label).string=a.Windown.formatMoney(t),e.active=!0,e},e.prototype.getChipBet=function(t){var e=null;0==this.chipBetPool.size()&&this.chipBetPool.put(cc.instantiate(this.chipBetTemp)),(e=this.chipBetPool.get()).active=!0,e.opacity=255,e.scale=1,e.value=0,e.gate=-1,e.playerID=0,e.isChipPayOther=null;var n=this.listBetValue.indexOf(t/1e3);return e.getComponent(cc.Sprite).spriteFrame=-1!=n?this.chipBetSprites[n]:this.chipBetSprites[this.chipBetSprites.length-1],e},r([l(cc.Node)],e.prototype,"chipBetTemp",void 0),r([l(cc.Animation)],e.prototype,"effectWin",void 0),r([l([cc.SpriteFrame])],e.prototype,"chipBetSprites",void 0),r([l(cc.SpriteAtlas)],e.prototype,"cardAtlas",void 0),r([c],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../../../Scritps/Windown":void 0}],"Baccarat.ButtonBet":[function(t,e,n){"use strict";cc._RF.push(e,"931e1pN48lEV4zRZ4h/Z0lo","Baccarat.ButtonBet");var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../Scritps/Windown"),s=cc._decorator,c=s.ccclass,l=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrBtn=null,e.btnX2=null,e.btnRebet=null,e.btnBetB=null,e.currbetBtnBet=null,e.chipBorder=null,e.listBetValue=[1,5,10,50,100,500,1e3,2e3,5e3,1e4,5e4,15e4,2e5],e.currentBetValue=1,e}return o(e,t),e.prototype.start=function(){var t=this;this.scrBtn.content.children.forEach(function(e,n){var i=new cc.Component.EventHandler;i.target=t.node,i.component="Baccarat.ButtonBet",i.handler="onClickBet",i.customEventData=t.listBetValue[n]+"",e.getComponent(cc.Button).clickEvents.push(i)}),this.currbetBtnBet.y=10},e.prototype.onClickBet=function(t,e){cc.log("clickbet:"+e),cc.tween(this.currbetBtnBet).to(.1,{y:0}).start(),this.currbetBtnBet=t.target,this.chipBorder.parent=this.currbetBtnBet,this.currentBetValue=1e3*parseInt(e),a.Windown.BaccaratView.currentBetValue=this.currentBetValue,cc.tween(this.currbetBtnBet).to(.1,{y:10}).start()},e.prototype.onClickX2=function(){},e.prototype.onClickRebet=function(){},e.prototype.onChangeListChip=function(t,e){var n=this.scrBtn.getScrollOffset(),i=this.scrBtn.getMaxScrollOffset();cc.log("currentOffset = "+this.scrBtn.getScrollOffset()),"previous"==e?n.x<0&&cc.tween(this.scrBtn.content).to(.3,{x:this.scrBtn.content.x+100}).start():Math.abs(n.x)<i.x&&cc.tween(this.scrBtn.content).to(.3,{x:this.scrBtn.content.x-100}).start()},r([l(cc.ScrollView)],e.prototype,"scrBtn",void 0),r([l(cc.Button)],e.prototype,"btnX2",void 0),r([l(cc.Button)],e.prototype,"btnRebet",void 0),r([l(cc.Button)],e.prototype,"btnBetB",void 0),r([l(cc.Node)],e.prototype,"currbetBtnBet",void 0),r([l(cc.Node)],e.prototype,"chipBorder",void 0),r([c],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../../../Scritps/Windown":void 0}],"Baccarat.ChipBet":[function(t,e,n){"use strict";cc._RF.push(e,"b2c9dxWN1hHoKMW78LL6xzK","Baccarat.ChipBet");var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerID=0,e.value=0,e.gate=-1,e}return o(e,t),r([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],"Baccarat.Player":[function(t,e,n){"use strict";cc._RF.push(e,"ad580J02flDJ5w8uubVmJFs","Baccarat.Player");var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function a(t){try{c(i.next(t))}catch(e){r(e)}}function s(t){try{c(i.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((i=i.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../Scritps/DefineTs/PathResource"),l=t("../../../Scritps/Obs/LbMoneyChange"),h=t("../../../Scritps/Util"),p=t("../../../Scritps/Windown"),u=cc._decorator,f=u.ccclass,d=u.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lbNickName=null,e.lbChips=null,e.avatar=null,e.lbChipWin=null,e.posPayChip=[],e.spineEffectWin=null,e.dynamicIndex=0,e.nickname="Player",e.currentChips=0,e.id=0,e.isThisPlayer=!1,e.listChipBet=[],e.listChipPay=[],e.gateBetted=[],e.effecWin=null,e}return o(e,t),e.prototype.start=function(){},e.prototype.setInfo=function(t,e,n,i){this.setName(e),this.setId(t),this.setChip(n),this.setAvatar(i)},e.prototype.setName=function(t){this.lbNickName.string=t,this.nickname=t,t.length>10&&(this.lbNickName.string=t.slice(0,7)+"...")},e.prototype.setChip=function(t,e){void 0===e&&(e=!0),this.isThisPlayer?this.lbChips.setMoney(t,!1):this.lbChips.setMoney(t,e),this.currentChips=t},e.prototype.setAvatar=function(t){return a(this,void 0,void 0,function(){var e,n;return s(this,function(i){switch(i.label){case 0:return e=c.PathResource.Avatar.replace("%d",t.toString()),[4,p.Windown.getSpFrameRes(e)];case 1:return n=i.sent(),this.avatar.spriteFrame=n,[2]}})})},e.prototype.setId=function(t){this.id=t},e.prototype.getChipBet=function(t){this.listChipBet.forEach(function(e){var n=t.parent.convertToWorldSpaceAR(t.position),i=e.parent.convertToNodeSpaceAR(n);cc.tween(e).to(1,{position:i},{easing:cc.easing.quintOut}).start(),cc.tween(e).to(1,{opacity:0},{easing:cc.easing.sineOut}).start()})},e.prototype.showWinEffect=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return[2,new Promise(function(n){return a(e,void 0,void 0,function(){var e=this;return s(this,function(){try{null==this.effecWin&&(this.effecWin=p.Windown.BaccaratView.assets.getEffectWin(t).getComponent(cc.Animation)),this.effecWin.node.parent=this.node,this.effecWin.node.active=!0,this.effecWin.getComponent(cc.Animation).play("EffectWin"),this.effecWin.once("finished",function(){e.effecWin.getComponent(cc.Animation).play("EndEffectWin"),e.effecWin.once("finished",function(){e.effecWin.node.active=!1,n(null)})})}catch(i){h.Util.ThrowErrProsime(i)}return[2]})})})]})})},e.prototype.showWinSpineEffect=function(t){var e=this;this.spineEffectWin.node.scale=1,this.spineEffectWin.node.active=!0,this.spineEffectWin.setSkin("win"),this.spineEffectWin.setSlotsToSetupPose(),this.spineEffectWin.setAnimation(0,"appear",!1),this.lbChipWin.string=p.Windown.formatMoney(t),this.lbChipWin.node.parent.active=!0,cc.tween(this.lbChipWin.node.parent).set({scaleX:0}).to(.3,{scaleX:.5},{easing:cc.easing.backOut}).start(),this.spineEffectWin.setCompleteListener(function(){e.spineEffectWin.setAnimation(1,"idle",!1),e.spineEffectWin.setCompleteListener(null)}),this.scheduleOnce(function(){e.hideSpineWin()},3)},e.prototype.hideSpineWin=function(){var t=this;cc.tween(this.spineEffectWin.node).to(.2,{scaleX:0},{easing:cc.easing.backIn}).call(function(){t.spineEffectWin.node.active=!1}).start()},e.prototype.showButtonBet=function(){this.node.getComponent(cc.Animation).play("EffectShowBtnBet")},e.prototype.hideButtonBet=function(){this.node.getComponent(cc.Animation).play("EffectHideBtnBet")},e.prototype.resetPlayer=function(){this.listChipBet=[],this.listChipPay=[],this.gateBetted=[]},r([d(cc.Label)],e.prototype,"lbNickName",void 0),r([d(l.default)],e.prototype,"lbChips",void 0),r([d(cc.Sprite)],e.prototype,"avatar",void 0),r([d(cc.Label)],e.prototype,"lbChipWin",void 0),r([d([cc.Vec2])],e.prototype,"posPayChip",void 0),r([d(sp.Skeleton)],e.prototype,"spineEffectWin",void 0),r([d],e.prototype,"isThisPlayer",void 0),r([f],e)}(cc.Component);n.default=y,cc._RF.pop()},{"../../../Scritps/DefineTs/PathResource":void 0,"../../../Scritps/Obs/LbMoneyChange":void 0,"../../../Scritps/Util":void 0,"../../../Scritps/Windown":void 0}],BaccaratController:[function(t,e,n){"use strict";cc._RF.push(e,"d65e4chFb9JX5TYXArxHQ4s","BaccaratController");var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function a(t){try{c(i.next(t))}catch(e){r(e)}}function s(t){try{c(i.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((i=i.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../../Scritps/DefineTs/EVENT_MANAGER"),a=t("../../../Scritps/DefineTs/REQUEST_CODE"),s=t("../../../Scritps/DefineTs/TextDefine"),c=t("../../../Scritps/Game/GAME_TYPE"),l=t("../../../Scritps/Network/ConectManager"),h=t("../../../Scritps/Windown"),p=function(){function t(){this.sfs=null,this.roomSFS=null,this.listTimeOut=[],this.objFinish=null,this.gameType=0,this.isCanSendData=!0,this.joinRoomData=null,this.infoRoom=null,this.sfs=l.ConectManager.getIns().sfs,this.sfs.addEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.userExitRoom,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_CREATION_ERROR,this.onCreateError,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onJoinRoom,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onJoinRoomErr,this),this.sfs.addEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.extResponse,this),h.Windown.BaccaratController=this,cc.systemEvent.on(r.EVENT_MANAGER.onDisconnect,this.onDisconnect,this)}return t.prototype.onDisconnect=function(){this.clear(),this.baccaratView.node.destroy()},t.prototype.clear=function(){cc.systemEvent.targetOff(this),this.sfs.removeEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.userExitRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onJoinRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onJoinRoomErr),this.sfs.removeEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.extResponse),this.objFinish&&(this.objFinish.get("agWin"),h.Windown.MoneyUser.removeDelay(this.gameType)),h.Windown.MoneyUser.endGameMOney(this.gameType)},t.prototype.userExitRoom=function(t){if("Baccarat"==t.room.groupId&&t.user.isItMe)return this.onDestroy(),void cc.director.loadScene("main")},t.prototype.onCreateError=function(){cc.log("creat err"),h.Windown.UIManager.hideLoading(),this.onDestroy(),h.Windown.Dialog.showLog(s.TextDefine.ERR_JOIN_ROOM)},t.prototype.onDestroy=function(){h.Windown.UIManager.hideLoadingData(),h.Windown.UIManager.hideLoading(),cc.systemEvent.removeAll(this),this.clearAllTimeOut(),this.sfs.removeEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.userExitRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_CREATION_ERROR,this.onCreateError),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onJoinRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onJoinRoomErr),this.sfs.removeEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.extResponse),h.Windown.BaccaratController=null,this.roomSFS=null,h.Windown.MoneyUser.targetOff(this),h.Windown.MoneyUser.endGameMOney(c.default.Baccarat)},t.prototype.clearAllTimeOut=function(){this.listTimeOut.forEach(function(t){clearTimeout(t)})},t.prototype.onJoinRoom=function(t){return i(this,void 0,void 0,function(){return o(this,function(){return t.room,h.Windown.UIManager.hideLoadingData(),[2]})})},t.prototype.onJoinRoomErr=function(){h.Windown.UIManager.hideLoading(),h.Windown.Dialog.showLog(s.TextDefine.ERR_JOIN_ROOM),this.onDestroy()},t.prototype.extResponse=function(t){var e=t.cmd,n=t.params;switch(cc.log("Baccarat Code:"+e+"\n"+h.Windown.SFSObjToJson(n)),e){case a.REQUEST_CODE.BCRPlayerInfo:this.baccaratView.handlePlayerInfo(n);break;case a.REQUEST_CODE.BCRInfoRoom:this.baccaratView.handleRoomInfo(n);break;case a.REQUEST_CODE.BCRStartGame:this.baccaratView.handleStartGame(n);break;case a.REQUEST_CODE.BCRBet:this.baccaratView.handlePlayerBet(n);break;case a.REQUEST_CODE.BCREndGame:this.baccaratView.handleEndGame(n)}},t.prototype.sendJoinRoom=function(){var t=this;h.Windown.UIManager.showLoading();var e=this.sfs.roomManager.getRoomListFromGroup("Baccarat").find(function(t){return cc.log("value"+t.getVariable("cj").value),t.containsVariable("cj")&&t.getVariable("cj").value});e?(this.roomSFS=e,e.isJoined?this.sendGetInfoRoom():(cc.log("nhay vao send join rom: "+e),this.sfs.send(new SFS2X.JoinRoomRequest(e,null,-1)))):setTimeout(function(){t.sendJoinRoom()},3e3)},t.prototype.sendGetInfoRoom=function(){this.sendRequest(a.REQUEST_CODE.TXinfoRoom,l.ConectManager.getIns().getSFSObj())},t.prototype.sendRequest=function(t,e){l.ConectManager.getIns().sendRequest(t,e,this.roomSFS)},t.prototype.sendToServer=function(t,e){this.isCanSendData&&null!=this.roomSFS&&(cc.log("SendTo Sv:",e),this.isCanSendData=!1,l.ConectManager.getIns().sendRequest(t,e,this.roomSFS))},t.prototype.sendBet=function(t,e){var n=l.ConectManager.getIns().getSFSObj();n.putLong("bet",e),n.putInt("id",t),this.sendToServer("bet",n)},t.prototype.intiGame=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return[4,h.Windown.loadBundle(c.default.Baccarat.toString())];case 1:return t=e.sent(),h.Windown.UIManager.showLoadingData(),t.preloadScene("Baccarat",{},function(t,e){h.Windown.UIManager.setPerData(t/e)},function(e){e?h.Windown.Dialog.showLog(s.TextDefine.Error):t.loadScene("Baccarat",function(t,e){if(t)return h.Windown.Dialog.showLog(s.TextDefine.Error),void h.Windown.UIManager.hideLoadingData();cc.director.runScene(e,null,function(){h.Windown.UIManager.hideLoadingData()})})}),[2]}})})},t}();n.default=p,cc._RF.pop()},{"../../../Scritps/DefineTs/EVENT_MANAGER":void 0,"../../../Scritps/DefineTs/REQUEST_CODE":void 0,"../../../Scritps/DefineTs/TextDefine":void 0,"../../../Scritps/Game/GAME_TYPE":void 0,"../../../Scritps/Network/ConectManager":void 0,"../../../Scritps/Windown":void 0}],BaccaratView:[function(t,e,n){"use strict";cc._RF.push(e,"91133cyz0FNj4WIQhDdRhjP","BaccaratView");var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function a(t){try{c(i.next(t))}catch(e){r(e)}}function s(t){try{c(i.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((i=i.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../Scritps/Obs/LbMoneyChange"),l=t("../../../Scritps/Other/MakeDelay"),h=t("../../../Scritps/Util"),p=t("../../../Scritps/Windown"),u=t("./Baccarat.Assets"),f=t("./Baccarat.Player"),d=cc._decorator,y=d.ccclass,g=d.property,B=cc.Enum({PLAYER:1,TIE:2,BANKER:3,PLAYER_PAIR:4,BANKER_PAIR:5}),v=cc.Enum({PLAYER:1,TIE:2,BANKER:3,PLAYER_PP:14,PLAYER_BP:15,PLAYER_PBP:145,BANKER_PP:34,BANKER_BP:35,BANKER_PBP:345,TIE_PP:24,TIE_BP:25,TIE_PBP:245}),b=cc.Enum({BETTING:1,FINISHED:2}),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.players=[],e.thisPlayer=null,e.assets=null,e.nodeGroupUser=null,e.nodeGateBet=[],e.listCardPlayer=[],e.listCardBanker=[],e.nodeGetChip=null,e.lbOtherPlayer=null,e.lbTimer=null,e.lbSession=null,e.sprTimer=null,e.lbScoreP=null,e.lbScoreB=null,e.animDealer=null,e.animWinResult=null,e.posPayChipOther=[],e.lbTotalBetB=null,e.lbTotalBetP=null,e.lbTotalBetT=null,e.lbTotalBetBP=null,e.lbTotalBetPP=null,e.listPosChipOnTable=[],e.currentTimer=60,e.totalBetB=0,e.totalBetP=0,e.totalBetBP=0,e.totalBetPP=0,e.totalBetT=0,e.agUser=0,e.currentBetValue=1e3,e.listTotalBetValue=null,e.listDataPlayerOther=[],e.listLbTotalBet=[],e.gateWin=null,e.gameState=b.BETTING,e.listValueChip=[.1,1,5,10,50,100,500,1e3,2e3,5e3,1e4,5e4,1e5,15e4,2e5],e.lastPlayerInfoData=null,e.makeDelay=null,e.infoCardOnTable_Player=[],e.infoCardOnTable_Banker=[],e.listChipBet=[],e.listChipbetOther=[],e.listBtnBet=[],e.isResetView=!1,e.listGateWin=[],e}return o(e,t),e.prototype.onLoad=function(){var t=this;this.nodeGateBet.forEach(function(e){t.listBtnBet.push(e.getComponent(cc.Button))});for(var e=0,n=this.listValueChip.length;e<n;e++)this.listValueChip[e]*=1e3;for(e=0;e<3;e++){var i=this.listCardPlayer[e],o={scaleX:i.scaleX,scaleY:i.scaleY,position:i.position,angle:i.angle,skew:cc.v2(i.skewX,i.skewY)};this.infoCardOnTable_Player.push(o);var r=this.listCardBanker[e],a={scaleX:r.scaleX,scaleY:r.scaleY,position:r.position,angle:r.angle,skew:cc.v2(r.skewX,r.skewY)};this.infoCardOnTable_Banker.push(a)}this.listTotalBetValue=[this.totalBetP,this.totalBetT,this.totalBetB,this.totalBetPP,this.totalBetBP],this.listLbTotalBet=[this.lbTotalBetP,this.lbTotalBetT,this.lbTotalBetB,this.lbTotalBetPP,this.lbTotalBetBP],p.Windown.BaccaratController.baccaratView=this,p.Windown.BaccaratView=this,null!=p.Windown.BaccaratController.joinRoomData&&(this.handlePlayerInfo(p.Windown.BaccaratController.joinRoomData),p.Windown.BaccaratController.joinRoomData=null),null!=p.Windown.BaccaratController.infoRoom&&(this.handleRoomInfo(p.Windown.BaccaratController.infoRoom),p.Windown.BaccaratController.infoRoom=null),this.makeDelay=new l.default(this)},e.prototype.start=function(){p.Windown.BaccaratController.sendJoinRoom()},e.prototype.getMakeDelay=function(t){return this.makeDelay.getDelay(t)},e.prototype.handlePlayerInfo=function(t){if(this.gameState!=b.FINISHED){this.listDataPlayerOther=[];var e=JSON.parse(p.Windown.SFSArrToJson(t.get("data"))),n=e.find(function(t){return t.id==p.Windown.User.userId});null!=n&&(cc.log("Co this player trong listPlayer, xoa no di"),e.splice(e.indexOf(n),1)),7==e.length&&(this.listDataPlayerOther.push(e.pop()),cc.log("Co 7 player trong listPlayer, xoa 1 thang  di:"+e.length));for(var i=0,o=e.length;i<o;i++){var r=e[i],a=this.players[i];cc.isValid(a)&&(a.node.active=!0,a.setInfo(r.id,r.nn,r.ag,r.iv))}this.lbOtherPlayer.string=t.getInt("so")+this.listDataPlayerOther.length+""}else this.lastPlayerInfoData=t},e.prototype.handleRoomInfo=function(t){p.Windown.UIManager.hideLoading(),this.currentTimer=t.getInt("time"),this.sprTimer.fillRange=this.currentTimer/30,this.onCountTimeRemain();var e=JSON.parse(p.Windown.SFSArrToJson(t.get("cur")));this.lbSession.string="#"+t.getInt("sision");var n=t.getBool("isG");if(this.gameState=n?b.BETTING:b.FINISHED,this.gameState==b.BETTING){this.thisPlayer.showButtonBet();for(var i=0;i<e.length;i++){for(var o=e[i],r=o.id,a=o.b,s=0;s<a.length;s++)for(var c=a[s].bet,l=this.getPlayerWithId(a[s].idP),h=this.getListChipValue(c),u=0,f=h.length;u<f;u++){var d=this.assets.getChipBet(h[u]);cc.isValid(l)?(l.listChipBet.push(d),d.playerID=l.id):(this.listChipbetOther.push(d),d.playerID=-1),this.listChipBet.push(d),d.parent=this.nodeGateBet[r-1],d.gate=r,d.value=h[u];var y=r>3?20:30,g=p.Windown.RandomNumber(this.listPosChipOnTable[r-1].x-y,this.listPosChipOnTable[r-1].x+y),v=p.Windown.RandomNumber(this.listPosChipOnTable[r-1].y-y,this.listPosChipOnTable[r-1].y+y);d.setPosition(cc.v2(g,v))}switch(r){case B.BANKER:this.totalBetB=o.t;break;case B.PLAYER:this.totalBetP=o.t;break;case B.BANKER_PAIR:this.totalBetBP=o.t;break;case B.PLAYER_PAIR:this.totalBetPP=o.t;break;case B.TIE:this.totalBetT=o.t}this.lbTotalBetB.setMoney(this.totalBetB,!0),this.lbTotalBetP.setMoney(this.totalBetP,!0),this.lbTotalBetBP.setMoney(this.totalBetBP,!0),this.lbTotalBetPP.setMoney(this.totalBetPP,!0),this.lbTotalBetT.setMoney(this.totalBetT,!0),cc.log("handlePlayerInfoo:listDataPlayerOther size="+this.listDataPlayerOther.length)}}this.thisPlayer.setAvatar(p.Windown.User.avatrId),this.thisPlayer.setName(p.Windown.User.nickName),this.thisPlayer.setChip(p.Windown.User.userAg,!1),this.players.unshift(this.thisPlayer),this.agUser=p.Windown.User.userAg},e.prototype.handleStartGame=function(t){cc.log("handleStartGame"),this.isResetView=!1,this.lbSession.string="#"+t.getInt("sision"),this.currentTimer=t.getInt("time"),this.lbTimer.string=this.currentTimer+"",this.sprTimer.fillRange=1,this.onCountTimeRemain(),this.setDealerAnim("Start_Bet",!1),this.thisPlayer.showButtonBet()},e.prototype.handlePlayerBet=function(t){var e=t.getInt("pid"),n=t.getInt("id");cc.log("handlePlayerBet PlayerID:",e+"--gateBet:"+n);for(var i=t.getLong("bet"),o=this.getListChipValue(i),r=0,a=o.length;r<a;r++){var s=this.assets.getChipBet(o[r]);this.listChipBet.push(s);var c=this.nodeGateBet[n-1],l=this.getPlayerWithId(e),h=null;null!=l?(h=c.convertToNodeSpaceAR(l.node.parent.convertToWorldSpaceAR(l.node.position)),l.setChip(t.getLong("ag")),l.listChipBet.push(s),s.playerID=l.id,l.gateBetted.includes(n)||l.gateBetted.push(n)):(h=c.convertToNodeSpaceAR(this.nodeGroupUser.parent.convertToWorldSpaceAR(this.nodeGroupUser.position)),this.listChipbetOther.push(s),s.playerID=-1),s.parent=c,s.gate=n,s.value=o[r],s.setPosition(h);var u=n>3?20:30,f=p.Windown.RandomNumber(this.listPosChipOnTable[n-1].x-u,this.listPosChipOnTable[n-1].x+u),d=p.Windown.RandomNumber(this.listPosChipOnTable[n-1].y-u,this.listPosChipOnTable[n-1].y+u),y=cc.v2(f,d);cc.tween(s).set({position:h}).to(.3,{x:y.x,y:y.y},{easing:cc.easing.sineOut}).start()}this.listTotalBetValue[n-1]=t.getLong("ttB"),this.listLbTotalBet[n-1].setMoney(this.listTotalBetValue[n-1],!0)},e.prototype.handleEndGame=function(t){return a(this,void 0,void 0,function(){var e,n,i,o,r,c,l,h,u,f,d,y,g,v,C,P=this;return s(this,function(m){switch(m.label){case 0:return cc.log("handleEndGame"),this.gameState=b.FINISHED,this.thisPlayer.hideButtonBet(),this.setDealerAnim("Stop_Bet"),e=JSON.parse(t.getUtfString("vP")),n=JSON.parse(t.getUtfString("vD")),i=JSON.parse(p.Windown.SFSArrToJson(t.get("d7"))),o=t.getLong("agW"),this.agUser=t.getLong("ag"),r=JSON.parse(p.Windown.SFSArrToJson(t.get("w"))),this.listGateWin=[],r.forEach(function(t){P.listGateWin.push(t.id)}),cc.log("vp====",e),cc.log("vD====",n),c=this.animDealer.findAnimation("Stop_Bet").duration,[4,p.Windown.BaccaratView.getMakeDelay(c+.5).prosime];case 1:return m.sent(),this.setDealerAnim("DealCard"),l=this.getScore(e),h=this.getScore(n),this.gateWin=parseInt(this.listGateWin.toString().split(",").join("")),cc.log("ScoreP:"+l+"==ScoreB"+h+"--gateWin:"+this.gateWin),u=this.infoCardOnTable_Player[0],cc.tween(this.listCardPlayer[0]).set({scaleX:.15,scaleY:.15,angle:-30,x:-95,y:149}).delay(.85).call(function(){P.listCardPlayer[0].active=!0,P.listCardPlayer[0].opacity=255}).to(.3,{scaleX:u.scaleX,scaleY:u.scaleY,angle:u.angle,skewX:u.skew.x,skewY:u.skew.y,position:u.position},{easing:cc.easing.sineIn}).start(),f=this.infoCardOnTable_Banker[0],cc.tween(this.listCardBanker[0]).set({scaleX:.15,scaleY:.15,angle:36,x:30,y:133}).delay(2.25).call(function(){P.openCard(P.listCardPlayer[0],e[0].I,u),P.listCardBanker[0].active=!0,P.listCardBanker[0].opacity=255}).to(.3,{scaleX:f.scaleX,scaleY:f.scaleY,angle:f.angle,skewX:f.skew.x,skewY:f.skew.y,position:f.position},{easing:cc.easing.sineIn}).start(),d=this.infoCardOnTable_Player[1],cc.tween(this.listCardPlayer[1]).set({scaleX:.15,scaleY:.15,angle:-36,x:-95,y:149}).delay(3.5).call(function(){P.openCard(P.listCardBanker[0],n[0].I,f),P.listCardPlayer[1].active=!0,P.listCardPlayer[1].opacity=255}).to(.3,{scaleX:d.scaleX,scaleY:d.scaleY,angle:d.angle,skewX:d.skew.x,skewY:d.skew.y,position:d.position},{easing:cc.easing.sineIn}).start(),y=this.infoCardOnTable_Banker[1],cc.tween(this.listCardBanker[1]).set({scaleX:.15,scaleY:.15,angle:36,x:30,y:133}).delay(4.85).call(function(){return a(P,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.openCard(this.listCardPlayer[1],e[1].I,d),this.listCardBanker[1].active=!0,this.listCardBanker[1].opacity=255,[4,this.getMakeDelay(.75).prosime];case 1:return t.sent(),this.showScore(B.PLAYER,e,!0),[2]}})})}).to(.3,{scaleX:y.scaleX,scaleY:y.scaleY,angle:y.angle,skewX:y.skew.x,skewY:y.skew.y,position:y.position},{easing:cc.easing.sineIn}).delay(1).call(function(){return a(P,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.openCard(this.listCardBanker[1],n[1].I,y),[4,this.getMakeDelay(.75).prosime];case 1:return t.sent(),[4,this.showScore(B.BANKER,n,!0)];case 2:return t.sent(),[2]}})})}).delay(1).start(),[4,this.getMakeDelay(7.25).prosime];case 2:return m.sent(),2!=e.length||2!=n.length?[3,4]:[4,this.getMakeDelay(1.5).prosime];case 3:return m.sent(),[3,8];case 4:return g=0,3==e.length&&(g=1.5,v=this.infoCardOnTable_Player[2],this.setDealerAnim("DealCard_Nan"),cc.tween(this.listCardPlayer[2]).set({scaleX:.15,scaleY:.15,angle:-36,x:-20,y:125}).delay(1.1).call(function(){P.listCardPlayer[2].active=!0,P.listCardPlayer[2].opacity=255}).to(.3,{scaleX:v.scaleX,scaleY:v.scaleY,angle:v.angle,skewX:v.skew.x,skewY:v.skew.y,position:v.position},{easing:cc.easing.sineIn}).call(function(){return a(P,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.openCard(this.listCardPlayer[2],e[2].I,v),[4,this.getMakeDelay(.5).prosime];case 1:return t.sent(),this.showScore(B.PLAYER,e,!1),[2]}})})}).start()),3!=n.length?[3,6]:[4,this.getMakeDelay(g).prosime];case 5:m.sent(),C=this.infoCardOnTable_Banker[2],this.setDealerAnim("DealCard_Table_Right"),cc.tween(this.listCardBanker[2]).set({scaleX:.15,scaleY:.15,angle:36,x:30,y:133}).delay(1.1).call(function(){return a(P,void 0,void 0,function(){return s(this,function(){return this.listCardBanker[2].active=!0,this.listCardBanker[2].opacity=255,[2]})})}).to(.3,{scaleX:C.scaleX,scaleY:C.scaleY,angle:C.angle,skewX:C.skew.x,skewY:C.skew.y,position:C.position},{easing:cc.easing.sineIn}).call(function(){return a(P,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.openCard(this.listCardBanker[2],n[2].I,C),[4,this.getMakeDelay(.5).prosime];case 1:return t.sent(),this.showScore(B.BANKER,n,!1),[2]}})})}).start(),m.label=6;case 6:return[4,this.getMakeDelay(2.8).prosime];case 7:m.sent(),m.label=8;case 8:return[4,this.showWinResult()];case 9:return m.sent(),this.getAllChipOnTable(),[4,this.getMakeDelay(1.5).prosime];case 10:return m.sent(),this.payChipWinOnTalbe(),[4,this.getMakeDelay(1.5).prosime];case 11:return m.sent(),this.moveChipToPlayer(),[4,this.getMakeDelay(1.5).prosime];case 12:return m.sent(),[4,this.showResultAgWin(i,o)];case 13:return m.sent(),this.resetView(),[2]}})})},e.prototype.getAllChipOnTable=function(){var t=this;cc.log("this.listGateWin="+this.listGateWin),this.listChipBet.forEach(function(e){if(!t.listGateWin.includes(e.gate)){var n=t.nodeGetChip.parent.convertToWorldSpaceAR(t.nodeGetChip.position),i=e.parent.convertToNodeSpaceAR(n);cc.tween(e).delay(p.Windown.RandomNumber(0,3)/10).to(1.5,{position:i},{easing:cc.easing.quintOut}).to(.1,{opacity:0}).call(function(){t.assets.chipBetPool.put(e);var n=t.getPlayerWithId(e.playerID);null!=n&&n.listChipBet.splice(n.listChipBet.indexOf(e),1),t.listChipbetOther.includes(e)&&t.listChipbetOther.splice(t.listChipbetOther.indexOf(e),1)}).start()}})},e.prototype.payChipWinOnTalbe=function(){for(var t=this,e=function(e){var i=n.listGateWin[e];n.players.forEach(function(e){e.listChipBet.forEach(function(n,o){if(n.gate==i){n.value=t.getChipWinValueOnGate(n.value,i);for(var r=t.getListChipValue(n.value),a=0,s=r.length;a<s;a++)t.effectChipPay(r[a],i,.07*o,e.listChipPay)}})}),cc.log("tra chip cho minh: chipbet cua minh size="+n.thisPlayer.listChipBet),n.listChipbetOther.forEach(function(e,n){if(e.gate==i){e.value=t.getChipWinValueOnGate(e.value,i);for(var o=t.getListChipValue(e.value),r=0,a=o.length;r<a;r++)t.effectChipPay(o[r],i,.07*n,t.listChipbetOther)}})},n=this,i=0;i<this.listGateWin.length;i++)e(i)},e.prototype.getChipWinValueOnGate=function(t,e){return e!=B.PLAYER_PAIR&&e!=B.BANKER_PAIR||(t*=15),e==B.TIE&&(t*=9),t},e.prototype.moveChipToPlayer=function(){var t=this,e=cc.find("bg/playerContainer",this.node);this.players.forEach(function(n){n.listChipBet.forEach(function(i,o){if(o<7){var r=p.Windown.convertNodeInOtherNode(i,e);i.parent=e,i.setPosition(r),cc.tween(i).to(.6,{x:n.posPayChip[0].x,y:n.posPayChip[0].y+5*o,scale:.8*i.scale}).delay(1).to(.3,{position:n.node.position}).call(function(){t.assets.chipBetPool.put(i)}).start()}else cc.tween(i).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){t.assets.chipBetPool.put(i),o==n.listChipBet.length-1&&(n.listChipBet=[])})}),n.listChipPay.forEach(function(i,o){if(o<7){var r=p.Windown.convertNodeInOtherNode(i,e);i.parent=e,i.setPosition(r),cc.tween(i).to(.6,{x:n.posPayChip[1].x,y:n.posPayChip[1].y+5*o,scale:.8*i.scale}).delay(.75).to(.3,{position:n.node.position}).call(function(){t.assets.chipBetPool.put(i)}).start()}else cc.tween(i).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){t.assets.chipBetPool.put(i),o==n.listChipPay.length-1&&(n.listChipPay=[])})})}),this.listChipbetOther.forEach(function(n,i){if(i<5){var o=p.Windown.convertNodeInOtherNode(n,e);n.parent=e,n.setPosition(o);var r=1==n.isChipPayOther?0:1;cc.tween(n).to(.6,{x:t.posPayChipOther[r].x,y:t.posPayChipOther[r].y+5*i,scale:.8*n.scale}).delay(.75).to(.3,{position:t.nodeGroupUser.position}).call(function(){t.assets.chipBetPool.put(n)}).start()}else t.assets.chipBetPool.put(n),i==t.listChipbetOther.length-1&&(t.listChipbetOther=[])})},e.prototype.showResultAgWin=function(t,e){return void 0===t&&(t=[]),a(this,void 0,void 0,function(){var n,i=this;return s(this,function(o){switch(o.label){case 0:return n=[],t.forEach(function(t){var e=t.id;if(e!=i.thisPlayer.id){var o=i.getPlayerWithId(e);cc.isValid(o)&&t.agw>0&&(n.push(o.showWinEffect(t.agw)),o.setChip(t.ag))}}),0!=e&&(n.push(this.thisPlayer.showWinSpineEffect(e)),this.thisPlayer.setChip(this.agUser)),[4,Promise.all(n)];case 1:return o.sent(),[4,this.getMakeDelay(.25).prosime];case 2:return o.sent(),[2]}})})},e.prototype.endResultAgWin=function(){},e.prototype.resetView=function(){var t=this;this.isResetView||(this.isResetView=!0,this.listChipBet.forEach(function(e){t.assets.chipBetPool.put(e)}),this.listChipBet=[],this.listChipbetOther.forEach(function(e){t.assets.chipBetPool.put(e)}),this.listChipbetOther=[],this.totalBetB=this.totalBetP=this.totalBetPP=this.totalBetBP=0,this.listBtnBet.forEach(function(t){t.getComponentInChildren(cc.Animation).node.active=!1}),this.animWinResult.node.active=!1,this.setDealerAnim("DiscardCard"),this.listCardBanker.forEach(function(e,n){cc.tween(e).delay(.1*n).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){e.getComponent(cc.Sprite).spriteFrame=t.assets.getCardBack()}).start()}),this.listCardPlayer.forEach(function(e,n){cc.tween(e).delay(.1*n).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){e.getComponent(cc.Sprite).spriteFrame=t.assets.getCardBack()}).start()}),this.lbScoreP.node.active=!1,this.lbScoreB.node.active=!1,this.players.forEach(function(t){t.resetPlayer()}),null!=this.lastPlayerInfoData&&(this.handlePlayerInfo(this.lastPlayerInfoData),this.lastPlayerInfoData=null),this.listLbTotalBet.forEach(function(t){t.setMoney(0)}))},e.prototype.effectChipPay=function(t,e,n,i){var o=this.assets.getChipBet(t);o.isChipPayOther=i==this.listChipbetOther,i.push(o);var r=this.nodeGateBet[e-1];o.parent=r;var a=e>3?20:30,s=p.Windown.RandomNumber(this.listPosChipOnTable[e-1].x-a,this.listPosChipOnTable[e-1].x+a),c=p.Windown.RandomNumber(this.listPosChipOnTable[e-1].y-a,this.listPosChipOnTable[e-1].y+a),l=cc.v2(s,c);n=n<.75?n:.75,cc.tween(o).delay(n).set({x:l.x,y:l.y+50,opacity:0}).to(.3,{x:l.x,y:l.y,opacity:255},{easing:cc.easing.sineIn}).start()},e.prototype.showWinResult=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return[2,new Promise(function(e){return a(t,void 0,void 0,function(){var t,n,i,o=this;return s(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.animWinResult.node.active=!0,cc.tween(this.animWinResult.node).set({scale:0,opacity:0}).to(.75,{scale:1,opacity:255},{easing:cc.easing.elasticOut}).start(),cc.find("bgWinResult/lbWin",this.animWinResult.node).getComponent(cc.Label).string="WIN",t="",this.getGateWinNormal()==B.TIE?(this.animWinResult.node.x=0,cc.find("bgWinResult/lbWin",this.animWinResult.node).getComponent(cc.Label).string="H\xd2A",t="Win_Draw"):this.getGateWinNormal()==B.PLAYER?(this.animWinResult.node.x=-170,t="Win_Player"):(this.animWinResult.node.x=170,t="Win_Banker"),this.setDealerAnim(t),n=this.getGateWinNormal()==B.TIE?"TieWin":"BankerWin",this.animWinResult.play(n),this.listGateWin.forEach(function(t){o.listBtnBet[t-1].getComponentInChildren(cc.Animation).node.active=!0}),[4,this.getMakeDelay(1.5).prosime];case 1:return r.sent(),e(null),[3,3];case 2:return i=r.sent(),h.Util.ThrowErrProsime(i),[3,3];case 3:return[2]}})})})]})})},e.prototype.setDealerAnim=function(t,e,n){var i=this;void 0===e&&(e=!1),void 0===n&&(n=null),this.animDealer.setAnimation(0,t,e),this.animDealer.setCompleteListener(null),null!=n?(this.animDealer.setCompleteListener(n),this.animDealer.setCompleteListener(null)):this.animDealer.setCompleteListener(function(){i.animDealer.setAnimation(0,"Idle_Tap",!0)})},e.prototype.showScore=function(t,e,n){cc.log("arrCArd= ",e);var i=n?2:3,o=this.getScore(e,i),r=cc.tween().set({scale:0}).to(.3,{scale:1},{easing:cc.easing.backOut});t==B.PLAYER?(this.lbScoreP.node.active=!0,n?(this.lbScoreP.setMoneyNoTime(o),r.clone(this.lbScoreP.node).start()):this.lbScoreP.setMoney(o)):(this.lbScoreB.node.active=!0,n?(this.lbScoreB.setMoneyNoTime(o),r.clone(this.lbScoreB.node).start()):this.lbScoreB.setMoney(o))},e.prototype.getScore=function(t,e){void 0===e&&(e=2);for(var n=0,i=0;i<e;i++){var o=t[i];n+=o.N>=10?0:o.N}return n%10},e.prototype.openCard=function(t,e,n){var i=this,o=0;o=t.x>0?10:-10,t.x,t.getPosition(),cc.tween(t).to(.55,{scaleX:.01,angle:n.angle+10,skewX:n.skew.x+o},{easing:cc.easing.cubicInOut}).call(function(){t.getComponent(cc.Sprite).spriteFrame=i.assets.getCardSprite(e)}).to(.2,{scaleX:n.scaleX,angle:n.angle,skewX:n.skew.x},{easing:cc.easing.cubicInOut}).start()},e.prototype.onCountTimeRemain=function(){var t=this;this.lbTimer.string=this.currentTimer+"",this.schedule(function(){t.currentTimer>0?(t.lbTimer.string=t.currentTimer+"",t.currentTimer--):t.lbTimer.string="0"},1,this.currentTimer),cc.tween(this.sprTimer).to(this.currentTimer,{fillRange:0}).start()},e.prototype.getPlayerWithId=function(t){return t==p.Windown.User.userId?this.thisPlayer:this.players.find(function(e){return e.id==t})},e.prototype.getListChipValue=function(t){var e=[];return this.getNameChip(t,e),e},e.prototype.getNameChip=function(t,e){for(var n,i,o=0,r=0;r<this.listValueChip.length;r++)if(this.listValueChip[r]>t){o=this.listValueChip[r-1];break}if(0==o)for(r=this.listValueChip.length-1;r>=0;r++)if(t>=this.listValueChip[r]){o=this.listValueChip[r];break}if(n=Math.floor(t/o),t=i=t%o,o>=1e3)for(r=0;r<n;r++)e.push(o);i>0&&this.getNameChip(t,e)},e.prototype.getGateWinNormal=function(){var t=0;switch(this.gateWin){case v.PLAYER:case v.PLAYER_BP:case v.PLAYER_PP:case v.PLAYER_PBP:t=v.PLAYER;break;case v.BANKER:case v.BANKER_BP:case v.BANKER_PP:case v.BANKER_PBP:t=v.BANKER;break;case v.TIE:case v.TIE_BP:case v.TIE_PP:case v.TIE_PBP:t=v.TIE}return t},e.prototype.onClickSendBet=function(t,e){cc.log("onClickSendBet:",e),p.Windown.BaccaratController.sendBet(parseInt(e),this.currentBetValue),setTimeout(function(){p.Windown.BaccaratController.isCanSendData=!0},500)},r([g([f.default])],e.prototype,"players",void 0),r([g(f.default)],e.prototype,"thisPlayer",void 0),r([g(u.default)],e.prototype,"assets",void 0),r([g(cc.Node)],e.prototype,"nodeGroupUser",void 0),r([g([cc.Node])],e.prototype,"nodeGateBet",void 0),r([g([cc.Node])],e.prototype,"listCardPlayer",void 0),r([g([cc.Node])],e.prototype,"listCardBanker",void 0),r([g(cc.Node)],e.prototype,"nodeGetChip",void 0),r([g(cc.Label)],e.prototype,"lbOtherPlayer",void 0),r([g(cc.Label)],e.prototype,"lbTimer",void 0),r([g(cc.Label)],e.prototype,"lbSession",void 0),r([g(cc.Sprite)],e.prototype,"sprTimer",void 0),r([g(c.default)],e.prototype,"lbScoreP",void 0),r([g(c.default)],e.prototype,"lbScoreB",void 0),r([g(sp.Skeleton)],e.prototype,"animDealer",void 0),r([g(cc.Animation)],e.prototype,"animWinResult",void 0),r([g([cc.Vec2])],e.prototype,"posPayChipOther",void 0),r([g(c.default)],e.prototype,"lbTotalBetB",void 0),r([g(c.default)],e.prototype,"lbTotalBetP",void 0),r([g(c.default)],e.prototype,"lbTotalBetT",void 0),r([g(c.default)],e.prototype,"lbTotalBetBP",void 0),r([g(c.default)],e.prototype,"lbTotalBetPP",void 0),r([g([cc.Vec2])],e.prototype,"listPosChipOnTable",void 0),r([y],e)}(cc.Component);n.default=C,cc._RF.pop()},{"../../../Scritps/Obs/LbMoneyChange":void 0,"../../../Scritps/Other/MakeDelay":void 0,"../../../Scritps/Util":void 0,"../../../Scritps/Windown":void 0,"./Baccarat.Assets":"Baccarat.Assets","./Baccarat.Player":"Baccarat.Player"}]},{},["Baccarat.Assets","Baccarat.ButtonBet","Baccarat.ChipBet","Baccarat.Player","BaccaratController","BaccaratView"]);