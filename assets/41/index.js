window.__require=function t(e,i,n){function o(r,s){if(!i[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var p=i[r]={exports:{}};e[r][0].call(p.exports,function(t){return o(e[r][1][t]||t)},p,p.exports,t,e,i,n)}return i[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<n.length;r++)o(n[r]);return o}({"Baccarat.Assets":[function(t,e,i){"use strict";cc._RF.push(e,"c3929B7DJJFJ56uustrPN2z","Baccarat.Assets");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../Scritps/Windown"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chipBetTemp=null,e.effectWin=null,e.chipBetSprites=[],e.listBetValue=[1,5,10,50,100,500,1e3,2e3,5e3,1e4,5e4,1e5,15e4,2e5],e.chipBetPool=null,e.cardAtlas=null,e.spriteCard=[],e}return o(e,t),e.prototype.onLoad=function(){this.chipBetPool=new cc.NodePool("chipbet");for(var t=39;t<52;t++)this.spriteCard.push(this.cardAtlas.getSpriteFrame(t+""));for(t=26;t<39;t++)this.spriteCard.push(this.cardAtlas.getSpriteFrame(t+""));for(t=0;t<13;t++)this.spriteCard.push(this.cardAtlas.getSpriteFrame(t+""));for(t=13;t<26;t++)this.spriteCard.push(this.cardAtlas.getSpriteFrame(t+""))},e.prototype.start=function(){},e.prototype.getCardSprite=function(t){return this.spriteCard[t-1]},e.prototype.getCardBack=function(){return this.cardAtlas.getSpriteFrame("52")},e.prototype.getEffectWin=function(t,e){void 0===e&&(e=!1);var i=cc.instantiate(this.effectWin);return i.getChildByName("lbChipWin").getComponent(cc.Label).string=r.Windown.formatMoney(t),i.active=!0,i},e.prototype.getChipBet=function(t){var e=null;0==this.chipBetPool.size()&&this.chipBetPool.put(cc.instantiate(this.chipBetTemp)),(e=this.chipBetPool.get()).active=!0,e.opacity=255,e.scale=1,e.value=0,e.gate=-1,e.playerID=0,e.isChipPayOther=null;var i=this.listBetValue.indexOf(t/1e3);return e.getComponent(cc.Sprite).spriteFrame=-1!=i?this.chipBetSprites[i]:this.chipBetSprites[this.chipBetSprites.length-1],e},a([l(cc.Node)],e.prototype,"chipBetTemp",void 0),a([l(cc.Node)],e.prototype,"effectWin",void 0),a([l([cc.SpriteFrame])],e.prototype,"chipBetSprites",void 0),a([l(cc.SpriteAtlas)],e.prototype,"cardAtlas",void 0),a([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../../../Scritps/Windown":void 0}],"Baccarat.Audio":[function(t,e,i){"use strict";cc._RF.push(e,"8ca9efPaMxHzZsWZa9sBXbH","Baccarat.Audio");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../Scritps/Parent/AudioManager"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgm_fs=null,e.click=null,e.flipCard=null,e.openCard=null,e.bankerWin=null,e.playerWin=null,e.youWin=null,e.gateWinEffect=null,e.dealer_startBet=null,e.dealer_endBet=null,e.getChip=null,e.chipMoveToPlayer_turn1=null,e.chipMoveToPlayer_turn2=null,e.throwChip=null,e.openPopup=null,e.fsSpin=null,e}return o(e,t),e.prototype.start=function(){},e.prototype.playClick=function(){this.playEffect(this.click)},e.prototype.playMusic=function(){cc.log("chay vao play music "+this.isActiveMusic),this.isActiveMusic&&this.backgroundMusicAudio&&(cc.audioEngine.playMusic(this.backgroundMusicAudio,!0),cc.audioEngine.setMusicVolume(1))},e.prototype.playIndexTakeLine=function(){},e.prototype.playSmalWin=function(){},e.prototype.playBkgfs=function(){this.stopMusic(),this.playEffect(this.bgm_fs,.6,!0)},e.prototype.stopBkgFs=function(){this.stopEffect(this.bgm_fs,!0),this.playMusic()},a([l(cc.AudioClip)],e.prototype,"bgm_fs",void 0),a([l(cc.AudioClip)],e.prototype,"click",void 0),a([l(cc.AudioClip)],e.prototype,"flipCard",void 0),a([l(cc.AudioClip)],e.prototype,"openCard",void 0),a([l(cc.AudioClip)],e.prototype,"bankerWin",void 0),a([l(cc.AudioClip)],e.prototype,"playerWin",void 0),a([l(cc.AudioClip)],e.prototype,"youWin",void 0),a([l(cc.AudioClip)],e.prototype,"gateWinEffect",void 0),a([l(cc.AudioClip)],e.prototype,"dealer_startBet",void 0),a([l(cc.AudioClip)],e.prototype,"dealer_endBet",void 0),a([l(cc.AudioClip)],e.prototype,"getChip",void 0),a([l(cc.AudioClip)],e.prototype,"chipMoveToPlayer_turn1",void 0),a([l(cc.AudioClip)],e.prototype,"chipMoveToPlayer_turn2",void 0),a([l(cc.AudioClip)],e.prototype,"throwChip",void 0),a([l(cc.AudioClip)],e.prototype,"openPopup",void 0),a([l(cc.AudioClip)],e.prototype,"fsSpin",void 0),a([c],e)}(r.default);i.default=p,cc._RF.pop()},{"../../../Scritps/Parent/AudioManager":void 0}],"Baccarat.ButtonBet":[function(t,e,i){"use strict";cc._RF.push(e,"931e1pN48lEV4zRZ4h/Z0lo","Baccarat.ButtonBet");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../Scritps/Windown"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrBtn=null,e.btnX2=null,e.btnRebet=null,e.btnBetB=null,e.currbetBtnBet=null,e.chipBorder=null,e.listBetValue=[1,5,10,50,100,500,1e3,2e3,5e3,1e4,5e4,15e4,2e5],e.currentBetValue=1,e}return o(e,t),e.prototype.start=function(){var t=this;this.scrBtn.content.children.forEach(function(e,i){var n=new cc.Component.EventHandler;n.target=t.node,n.component="Baccarat.ButtonBet",n.handler="onClickBet",n.customEventData=t.listBetValue[i]+"",e.getComponent(cc.Button).clickEvents.push(n)}),this.currbetBtnBet.y=10},e.prototype.onClickBet=function(t,e){cc.log("clickbet:"+e),r.Windown.BaccaratView.audio.playEffect(r.Windown.BaccaratView.audio.chipMoveToPlayer_turn1),cc.tween(this.currbetBtnBet).to(.1,{y:0}).start(),this.currbetBtnBet=t.target,this.chipBorder.parent=this.currbetBtnBet,this.currentBetValue=1e3*parseInt(e),r.Windown.BaccaratView.currentBetValue=this.currentBetValue,cc.tween(this.currbetBtnBet).to(.1,{y:10}).start()},e.prototype.onClickX2=function(){var t=r.Windown.BaccaratView.HistoryBet.getTotalHistoryBet(),e=r.Windown.BaccaratView.HistoryBet.ListGateBet;if(2*t>r.Windown.User.userAg)r.Windown.UIManager.showAlertMini("B\u1ea1n kh\xf4ng \u0111\u1ee7 ti\u1ec1n c\u01b0\u1ee3c X2!");else{for(var i=0;i<5;i++)e[i]>0&&(r.Windown.BaccaratController.sendBet(i+1,2*e[i]),r.Windown.BaccaratController.isCanSendData=!0);this.btnRebet.interactable=!1,this.btnX2.interactable=!1}},e.prototype.onClickRebet=function(){var t=r.Windown.BaccaratView.HistoryBet.getTotalHistoryBet(),e=r.Windown.BaccaratView.HistoryBet.ListGateBet;if(t>r.Windown.User.userAg)r.Windown.UIManager.showAlertMini("B\u1ea1n kh\xf4ng \u0111\u1ee7 ti\u1ec1n c\u01b0\u1ee3c l\u1ea1i!");else{for(var i=0;i<5;i++)e[i]>0&&(r.Windown.BaccaratController.sendBet(i+1,e[i]),r.Windown.BaccaratController.isCanSendData=!0);this.btnRebet.interactable=!1,this.btnX2.interactable=!1}},e.prototype.onChangeListChip=function(t,e){var i=this.scrBtn.getScrollOffset(),n=this.scrBtn.getMaxScrollOffset();"previous"==e?i.x<0&&cc.tween(this.scrBtn.content).to(.3,{x:this.scrBtn.content.x+100}).start():Math.abs(i.x)<n.x&&cc.tween(this.scrBtn.content).to(.3,{x:this.scrBtn.content.x-100}).start()},e.prototype.setStatusBtnBet=function(){var t=r.Windown.BaccaratView.HistoryBet.getTotalHistoryBet();cc.log("setStatusBtnBet:"+t),t>0?(this.btnRebet.interactable=t<=r.Windown.User.userAg,this.btnX2.interactable=2*t<r.Windown.User.userAg):this.btnRebet.interactable=this.btnX2.interactable=!1},a([l(cc.ScrollView)],e.prototype,"scrBtn",void 0),a([l(cc.Button)],e.prototype,"btnX2",void 0),a([l(cc.Button)],e.prototype,"btnRebet",void 0),a([l(cc.Button)],e.prototype,"btnBetB",void 0),a([l(cc.Node)],e.prototype,"currbetBtnBet",void 0),a([l(cc.Node)],e.prototype,"chipBorder",void 0),a([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../../../Scritps/Windown":void 0}],"Baccarat.ChipBet":[function(t,e,i){"use strict";cc._RF.push(e,"b2c9dxWN1hHoKMW78LL6xzK","Baccarat.ChipBet");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerID=0,e.value=0,e.gate=-1,e}return o(e,t),a([s],e)}(cc.Component));i.default=c,cc._RF.pop()},{}],"Baccarat.HistoryBet":[function(t,e,i){"use strict";cc._RF.push(e,"e6d9eFbBkZBVYxeOPA7zija","Baccarat.HistoryBet");var n=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,a=o.ccclass,r=(o.property,function(){function t(){this.BET_PLAYER=0,this.BET_TIE=0,this.BET_BANKER=0,this.BET_PLAYER_P=0,this.BET_BANKER_P=0,this.ListGateBet=[this.BET_PLAYER,this.BET_TIE,this.BET_BANKER,this.BET_PLAYER_P,this.BET_BANKER_P]}return t.prototype.resetHistory=function(){this.ListGateBet.forEach(function(){})},t.prototype.getTotalHistoryBet=function(){var t=0;return this.ListGateBet.forEach(function(e){t+=e}),t},n([a],t)}());i.default=r,cc._RF.pop()},{}],"Baccarat.HistoryMini":[function(t,e,i){"use strict";cc._RF.push(e,"882baXqUhlKe44bJM1ERT8b","Baccarat.HistoryMini");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc.Enum({PLAYER:1,TIE:2,BANKER:3,PLAYER_PP:14,PLAYER_BP:15,PLAYER_PBP:145,BANKER_PP:34,BANKER_BP:35,BANKER_PBP:345,TIE_PP:24,TIE_BP:25,TIE_PBP:245}),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lbTotalBanker=null,e.lbTotalPlayer=null,e.lbTotalTie=null,e.itemContainer=null,e.itemTemplate=null,e.markRecentMatch=null,e.sprResult=[],e.startPosItem=null,e.spacingY=18,e.spacingX=22,e.totalBanker=0,e.totalPlayer=0,e.totalTie=0,e}return o(e,t),e.prototype.onLoad=function(){this.startPosItem=cc.v2(98.26,28.12)},e.prototype.start=function(){},e.prototype.setInfo=function(t,e){void 0===e&&(e=!1),t.length>40&&(t=t.slice(0,40));for(var i=0,n=t.length;i<n;i++){var o=void 0,a=this.getPosItem(i);(o=cc.instantiate(this.itemTemplate)).parent=this.itemContainer,o.setPosition(a),o.active=!0,o.setSiblingIndex(i);var s=t[i],c=null;switch(this.getTypeGate(s)){case r.BANKER:this.totalBanker++,c=this.sprResult[2];break;case r.PLAYER:this.totalPlayer++,c=this.sprResult[0];break;case r.TIE:this.totalTie++,c=this.sprResult[1]}null==c&&cc.log(" bi null:"+s+"---gate=="+this.getTypeGate(s)),o.getComponent(cc.Sprite).spriteFrame=c}this.lbTotalBanker.string=this.totalBanker+"",this.lbTotalPlayer.string=this.totalPlayer+"",this.lbTotalTie.string=this.totalTie+"",cc.tween(this.markRecentMatch).sequence(cc.tween().to(.5,{scale:1}),cc.tween().to(.5,{scale:.8})).repeatForever().start()},e.prototype.addItemHistory=function(t){var e=this;this.markRecentMatch.active=!1,t.length>40&&(t=t.slice(0,40));var i,n=cc.instantiate(this.itemTemplate);switch(n.parent=this.itemContainer,n.setSiblingIndex(0),n.active=!0,n.setPosition(cc.v2(this.getPosItem(0).x+100,this.getPosItem(0).y)),this.getTypeGate(t[0])){case r.BANKER:this.totalBanker++,this.lbTotalBanker.string=this.totalBanker+"",i=this.sprResult[2];break;case r.PLAYER:this.totalPlayer++,i=this.sprResult[0],this.lbTotalPlayer.string=this.totalPlayer+"";break;case r.TIE:this.totalTie++,i=this.sprResult[1],this.lbTotalTie.string=this.totalTie+""}n.getComponent(cc.Sprite).spriteFrame=i;for(var o=function(t,i){var n=a.itemContainer.children[t],o=a.getPosItem(t);cc.tween(n).to(.3,{x:o.x,y:o.y}).call(function(){t==i-1&&(e.markRecentMatch.active=!0,cc.tween(e.markRecentMatch).sequence(cc.tween().to(.5,{scale:1}),cc.tween().to(.5,{scale:.8})).repeatForever().start())}).start()},a=this,s=0,c=t.length;s<c;s++)o(s,c);var l=this.itemContainer.children[this.itemContainer.childrenCount-1];cc.tween(l).to(.3,{x:l.x-100}).call(function(){l.destroy()}).start()},e.prototype.getPosItem=function(t){var e=cc.v2(0,0);if(t<4)e=cc.v2(this.startPosItem.x,this.startPosItem.y-t*this.spacingY);else{var i=Math.floor(t/4);e.x=this.startPosItem.x-i*this.spacingX,e.y=i%2==0?this.startPosItem.y-t%4*this.spacingY:this.startPosItem.y-(3-t%4)*this.spacingY}return e},e.prototype.getTypeGate=function(t){var e;switch(t){case r.BANKER:case r.BANKER_PP:case r.BANKER_BP:case r.BANKER_PBP:e=r.BANKER;break;case r.PLAYER:case r.PLAYER_PP:case r.PLAYER_BP:case r.PLAYER_PBP:e=r.PLAYER;break;case r.TIE:case r.TIE_PP:case r.TIE_BP:case r.TIE_PBP:e=r.TIE}return e},a([l(cc.Label)],e.prototype,"lbTotalBanker",void 0),a([l(cc.Label)],e.prototype,"lbTotalPlayer",void 0),a([l(cc.Label)],e.prototype,"lbTotalTie",void 0),a([l(cc.Node)],e.prototype,"itemContainer",void 0),a([l(cc.Node)],e.prototype,"itemTemplate",void 0),a([l(cc.Node)],e.prototype,"markRecentMatch",void 0),a([l([cc.SpriteFrame])],e.prototype,"sprResult",void 0),a([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{}],"Baccarat.MenuView":[function(t,e,i){"use strict";cc._RF.push(e,"6dda6oiz2lCWIhPjbSY5E8H","Baccarat.MenuView");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,a){function r(t){try{c(n.next(t))}catch(e){a(e)}}function s(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(r,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var i,n,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return c([t,e])}}function c(a){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,n=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(s){a=[6,s],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../../../Scritps/Windown"),l=cc._decorator,p=l.ccclass,h=l.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.container=null,e}return o(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.onshow=function(){cc.tween(this.container).set({x:-cc.winSize.width/2-this.container.width/2-50}).to(.3,{x:-cc.winSize.width/2+this.container.width/2},{easing:cc.easing.sineIn}).start()},e.prototype.onHide=function(){cc.tween(this.container).set({x:-cc.winSize.width/2+this.container.width/2}).to(.3,{x:-cc.winSize.width/2-this.container.width/2-50},{easing:cc.easing.sineOut}).start()},e.prototype.onClickBack=function(){c.Windown.BaccaratView.audio.playClick(),c.Windown.BaccaratController.onClickBackToLobby()},e.prototype.onClickRule=function(){return r(this,void 0,void 0,function(){var t,e;return s(this,function(i){switch(i.label){case 0:return c.Windown.BaccaratView.audio.playEffect(c.Windown.BaccaratView.audio.openPopup),[4,c.Windown.BaccaratController.loadPrefabBundle("PopupRule")];case 1:return t=i.sent(),(e=cc.instantiate(t)).parent=c.Windown.BaccaratView.node,c.Windown.actionEffectOpen(e),cc.find("Container/btnClose",e).once("click",function(){c.Windown.actionEffectClose(e,function(){e.destroy()})}),this.onHide(),[2]}})})},e.prototype.onClickHistoryBet=function(){return r(this,void 0,void 0,function(){var t,e;return s(this,function(i){switch(i.label){case 0:return[4,c.Windown.BaccaratController.loadPrefabBundle("PopupHistory")];case 1:return t=i.sent(),(e=cc.instantiate(t)).parent=c.Windown.BaccaratView.node,c.Windown.actionEffectOpen(e),this.onHide(),[2]}})})},e.prototype.onClickSetting=function(){return r(this,void 0,void 0,function(){var t,e;return s(this,function(i){switch(i.label){case 0:return c.Windown.BaccaratView.audio.playEffect(c.Windown.BaccaratView.audio.openPopup),[4,c.Windown.BaccaratController.loadPrefabBundle("PopupSetting")];case 1:return t=i.sent(),(e=cc.instantiate(t)).parent=c.Windown.BaccaratView.node,c.Windown.actionEffectOpen(e),this.onHide(),[2]}})})},a([h(cc.Node)],e.prototype,"container",void 0),a([p],e)}(cc.Component);i.default=u,cc._RF.pop()},{"../../../Scritps/Windown":void 0}],"Baccarat.Player":[function(t,e,i){"use strict";cc._RF.push(e,"ad580J02flDJ5w8uubVmJFs","Baccarat.Player");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,a){function r(t){try{c(n.next(t))}catch(e){a(e)}}function s(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(r,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var i,n,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return c([t,e])}}function c(a){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,n=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(s){a=[6,s],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../../../Scritps/DefineTs/PathResource"),l=t("../../../Scritps/Obs/LbMoneyChange"),p=t("../../../Scritps/Util"),h=t("../../../Scritps/Windown"),u=cc._decorator,d=u.ccclass,f=u.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lbNickName=null,e.lbChips=null,e.avatar=null,e.lbChipWin=null,e.posPayChip=[],e.spineEffectWin=null,e.dynamicIndex=0,e.nickname="Player",e.currentChips=0,e.id=0,e.isThisPlayer=!1,e.listChipBet=[],e.listChipPay=[],e.gateBetted=[],e.effecWin=null,e}return o(e,t),e.prototype.start=function(){},e.prototype.setInfo=function(t,e,i,n){this.setName(e),this.setId(t),this.setChip(i),this.setAvatar(n)},e.prototype.setName=function(t){this.lbNickName.string=t,this.nickname=t,t.length>10&&(this.lbNickName.string=t.slice(0,7)+"...")},e.prototype.setChip=function(t,e){void 0===e&&(e=!0),this.isThisPlayer?this.lbChips.setMoney(t,!1):this.lbChips.setMoney(t,e),this.currentChips=t},e.prototype.setAvatar=function(t){return r(this,void 0,void 0,function(){var e,i;return s(this,function(n){switch(n.label){case 0:return e=c.PathResource.Avatar.replace("%d",t.toString()),[4,h.Windown.getSpFrameRes(e)];case 1:return i=n.sent(),this.avatar.spriteFrame=i,[2]}})})},e.prototype.setId=function(t){this.id=t},e.prototype.getChipBet=function(t){this.listChipBet.forEach(function(e){var i=t.parent.convertToWorldSpaceAR(t.position),n=e.parent.convertToNodeSpaceAR(i);cc.tween(e).to(1,{position:n},{easing:cc.easing.quintOut}).start(),cc.tween(e).to(1,{opacity:0},{easing:cc.easing.sineOut}).start()})},e.prototype.showWinEffect=function(t,e){return void 0===e&&(e=!1),r(this,void 0,void 0,function(){var i=this;return s(this,function(){return[2,new Promise(function(n){return r(i,void 0,void 0,function(){var i,o=this;return s(this,function(){try{null==this.effecWin&&(this.effecWin=h.Windown.BaccaratView.assets.getEffectWin(t),this.effecWin.y=20),(i=this.effecWin.getComponentInChildren(sp.Skeleton)).setCompleteListener(null),this.effecWin.parent=this.node,this.effecWin.active=!0,e||(i.setSkin("win"),i.setSlotsToSetupPose(),i.setAnimation(0,"appear",!1),i.setCompleteListener(function(){i.setAnimation(0,"idle",!1),i.setCompleteListener(function(){i.setCompleteListener(null)})}),this.scheduleOnce(function(){n(null),o.effecWin.active=!1},3))}catch(a){p.Util.ThrowErrProsime(a)}return[2]})})})]})})},e.prototype.showWinSpineEffect=function(t){var e=this;this.spineEffectWin.node.scale=1,this.spineEffectWin.node.active=!0,this.lbChipWin.string=h.Windown.formatMoney(t),this.lbChipWin.node.parent.active=!0,this.spineEffectWin.setSkin("win"),this.spineEffectWin.setSlotsToSetupPose(),this.spineEffectWin.setAnimation(0,"appear",!1),cc.tween(this.lbChipWin.node.parent).set({scaleX:0}).to(.3,{scaleX:.5},{easing:cc.easing.backOut}).start(),this.spineEffectWin.setCompleteListener(function(){e.spineEffectWin.setAnimation(0,"idle",!1),e.spineEffectWin.setCompleteListener(null)}),this.scheduleOnce(function(){e.hideSpineWin()},3)},e.prototype.hideSpineWin=function(){var t=this;cc.tween(this.spineEffectWin.node).to(.2,{scaleX:0},{easing:cc.easing.backIn}).call(function(){t.spineEffectWin.node.active=!1}).start()},e.prototype.showButtonBet=function(){this.node.getComponent(cc.Animation).play("EffectShowBtnBet"),h.Windown.BaccaratView.buttonBetController.setStatusBtnBet()},e.prototype.hideButtonBet=function(){this.node.getComponent(cc.Animation).play("EffectHideBtnBet")},e.prototype.resetPlayer=function(){cc.log("resetPlayer"),this.listChipBet=[],this.listChipPay=[],this.gateBetted=[]},a([f(cc.Label)],e.prototype,"lbNickName",void 0),a([f(l.default)],e.prototype,"lbChips",void 0),a([f(cc.Sprite)],e.prototype,"avatar",void 0),a([f(cc.Label)],e.prototype,"lbChipWin",void 0),a([f([cc.Vec2])],e.prototype,"posPayChip",void 0),a([f(sp.Skeleton)],e.prototype,"spineEffectWin",void 0),a([f],e.prototype,"isThisPlayer",void 0),a([d],e)}(cc.Component);i.default=y,cc._RF.pop()},{"../../../Scritps/DefineTs/PathResource":void 0,"../../../Scritps/Obs/LbMoneyChange":void 0,"../../../Scritps/Util":void 0,"../../../Scritps/Windown":void 0}],"Baccarat.PopupHistory":[function(t,e,i){"use strict";cc._RF.push(e,"12b70F/6IlPrKo5cjLpFF6w","Baccarat.PopupHistory");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../Scritps/Windown"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listCardPlayer=[],e.listCardBanker=[],e.sprGate=[],e.lbSession=null,e.lbScoreP=null,e.lbScoreB=null,e.lbPage=null,e.scrItemHis=null,e.itemHisTemp=null,e.currentIndexSession=0,e.historyData=[],e}return o(e,t),e.prototype.onLoad=function(){r.Windown.BaccaratView.popupHistoryBetView=this,r.Windown.BaccaratView.audio.playEffect(r.Windown.BaccaratView.audio.openPopup)},e.prototype.start=function(){r.Windown.BaccaratController.sendGetHistoryBet()},e.prototype.setInfo=function(t){this.historyData=JSON.parse(r.Windown.SFSObjToJson(t)).history,this.historyData.reverse(),cc.log("historyData===",this.historyData),this.setInfoSession(this.historyData[this.currentIndexSession]),this.lbPage.string="1/"+this.historyData.length},e.prototype.setInfoSession=function(t){var e=this,i=t.round,n=r.Windown.formatDate(new Date(t.time),"HH:mm:ss dd/MM/yyyy");this.lbSession.string=cc.js.formatStr("S\u1ed1 Phi\xean:#%s(%s)",i,n);var o=JSON.parse(t.vP),a=JSON.parse(t.vD);o.forEach(function(t,i){0!=t.I&&(e.listCardPlayer[i].node.active=!0,e.listCardPlayer[i].spriteFrame=r.Windown.BaccaratView.assets.getCardSprite(t.I))}),a.forEach(function(t,i){0!=t.I&&(e.listCardBanker[i].spriteFrame=r.Windown.BaccaratView.assets.getCardSprite(t.I),e.listCardBanker[i].node.active=!0)}),this.listCardBanker[2].node.active=3==a.length&&0!=a[2].I,this.listCardPlayer[2].node.active=3==o.length&&0!=o[2].I,this.lbScoreP.string=r.Windown.BaccaratView.getScore(o,o.length)+"",this.lbScoreB.string=r.Windown.BaccaratView.getScore(a,a.length)+"",this.lbPage.string=this.currentIndexSession+1+"/"+this.historyData.length;var s=t.bet;this.scrItemHis.content.children.forEach(function(t){t.active=!1});for(var c=0;c<s.length;c++){var l=s[c],p=this.scrItemHis.content.children[c];cc.isValid(p)||((p=cc.instantiate(this.itemHisTemp)).parent=this.scrItemHis.content),p.active=!0,p.getComponentInChildren(cc.Sprite).spriteFrame=this.sprGate[l.id-1],p.getChildByName("lbbetValue").getComponent(cc.Label).string=r.Windown.formatMoney(l.agBet,1,100),0==l.agWin?(p.getChildByName("lbWinValue").getComponent(cc.Label).string="-"+r.Windown.formatMoney(l.agBet,1,100),p.getChildByName("lbWinValue").color=cc.Color.RED):(p.getChildByName("lbWinValue").color=cc.Color.GREEN,p.getChildByName("lbWinValue").getComponent(cc.Label).string="+"+r.Windown.formatMoney(l.agWin,1,100))}},e.prototype.onClickClose=function(){var t=this;r.Windown.actionEffectClose(this.node,function(){t.node.destroy(),r.Windown.BaccaratView.popupHistoryBetView=null}),r.Windown.BaccaratView.audio.playClick()},e.prototype.onClickChangePage=function(t,e){"next"==e?this.currentIndexSession<=this.historyData.length-2&&this.currentIndexSession++:this.currentIndexSession>0&&this.currentIndexSession--,this.setInfoSession(this.historyData[this.currentIndexSession])},a([l([cc.Sprite])],e.prototype,"listCardPlayer",void 0),a([l([cc.Sprite])],e.prototype,"listCardBanker",void 0),a([l([cc.SpriteFrame])],e.prototype,"sprGate",void 0),a([l(cc.Label)],e.prototype,"lbSession",void 0),a([l(cc.Label)],e.prototype,"lbScoreP",void 0),a([l(cc.Label)],e.prototype,"lbScoreB",void 0),a([l(cc.Label)],e.prototype,"lbPage",void 0),a([l(cc.ScrollView)],e.prototype,"scrItemHis",void 0),a([l(cc.Node)],e.prototype,"itemHisTemp",void 0),a([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../../../Scritps/Windown":void 0}],"Baccarat.SettingView":[function(t,e,i){"use strict";cc._RF.push(e,"50329oJ33tAQaFdbELw/pGK","Baccarat.SettingView");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../Scritps/Windown"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tglSound=null,e.tglMusic=null,e}return o(e,t),e.prototype.start=function(){this.tglSound.isChecked=!r.Windown.BaccaratView.audio.isActiveSound,this.tglMusic.isChecked=!r.Windown.BaccaratView.audio.isActiveMusic},e.prototype.onClickTglSound=function(){r.Windown.BaccaratView.audio.isActiveSound=!this.tglSound.isChecked},e.prototype.onClickTglMusic=function(){r.Windown.BaccaratView.audio.isActiveMusic=!this.tglMusic.isChecked},e.prototype.onClickClose=function(){var t=this;r.Windown.actionEffectClose(this.node,function(){t.node.destroy()}),r.Windown.BaccaratView.audio.playClick()},a([l(cc.Toggle)],e.prototype,"tglSound",void 0),a([l(cc.Toggle)],e.prototype,"tglMusic",void 0),a([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../../../Scritps/Windown":void 0}],BaccaratController:[function(t,e,i){"use strict";cc._RF.push(e,"d65e4chFb9JX5TYXArxHQ4s","BaccaratController");var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,a){function r(t){try{c(n.next(t))}catch(e){a(e)}}function s(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(r,s)}c((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var i,n,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return c([t,e])}}function c(a){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,n=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(s){a=[6,s],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var a=t("../../../Scritps/DefineTs/EVENT_MANAGER"),r=t("../../../Scritps/DefineTs/REQUEST_CODE"),s=t("../../../Scritps/DefineTs/TextDefine"),c=t("../../../Scritps/Game/GAME_TYPE"),l=t("../../../Scritps/Network/ConectManager"),p=t("../../../Scritps/Windown"),h=function(){function t(){this.sfs=null,this.roomSFS=null,this.listTimeOut=[],this.objFinish=null,this.gameType=0,this.isCanSendData=!0,this.joinRoomData=null,this.infoRoom=null,this.startGameData=null,this.sfs=l.ConectManager.getIns().sfs,this.sfs.addEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.userExitRoom,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_CREATION_ERROR,this.onCreateError,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onJoinRoom,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onJoinRoomErr,this),this.sfs.addEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.extResponse,this),p.Windown.BaccaratController=this,cc.systemEvent.on(a.EVENT_MANAGER.onDisconnect,this.onDisconnect,this)}return t.prototype.onDisconnect=function(){this.clear(),this.baccaratView.node.destroy()},t.prototype.clear=function(){cc.systemEvent.targetOff(this),this.sfs.removeEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.userExitRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onJoinRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onJoinRoomErr),this.sfs.removeEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.extResponse),this.objFinish&&(this.objFinish.get("agWin"),p.Windown.MoneyUser.removeDelay(this.gameType)),p.Windown.MoneyUser.endGameMOney(this.gameType)},t.prototype.userExitRoom=function(t){if("Baccarat"==t.room.groupId&&t.user.isItMe)return this.onDestroy(),void cc.director.loadScene("main")},t.prototype.onCreateError=function(){cc.log("creat err"),p.Windown.UIManager.hideLoading(),this.onDestroy(),p.Windown.Dialog.showLog(s.TextDefine.ERR_JOIN_ROOM)},t.prototype.onDestroy=function(){p.Windown.UIManager.hideLoadingData(),p.Windown.UIManager.hideLoading(),cc.systemEvent.removeAll(this),this.clearAllTimeOut(),this.sfs.removeEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.userExitRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_CREATION_ERROR,this.onCreateError),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onJoinRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onJoinRoomErr),this.sfs.removeEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.extResponse),p.Windown.BaccaratController=null,this.roomSFS=null,p.Windown.MoneyUser.targetOff(this),p.Windown.MoneyUser.endGameMOney(c.default.Baccarat)},t.prototype.clearAllTimeOut=function(){this.listTimeOut.forEach(function(t){clearTimeout(t)})},t.prototype.onJoinRoom=function(t){return n(this,void 0,void 0,function(){return o(this,function(){return t.room,p.Windown.UIManager.hideLoadingData(),[2]})})},t.prototype.onJoinRoomErr=function(){p.Windown.UIManager.hideLoading(),p.Windown.Dialog.showLog(s.TextDefine.ERR_JOIN_ROOM),this.onDestroy()},t.prototype.extResponse=function(t){var e=t.cmd,i=t.params;switch(cc.log("Baccarat Code:"+e+"\n"+p.Windown.SFSObjToJson(i)),e){case r.REQUEST_CODE.BCRPlayerInfo:this.baccaratView.handlePlayerInfo(i);break;case r.REQUEST_CODE.BCRInfoRoom:this.baccaratView.handleRoomInfo(i);break;case r.REQUEST_CODE.BCRStartGame:null==this.baccaratView?this.startGameData=i:this.baccaratView.handleStartGame(i);break;case r.REQUEST_CODE.BCRBet:cc.log("handlePlayerbet"),this.baccaratView.handlePlayerBet(i);break;case r.REQUEST_CODE.BCREndGame:this.baccaratView.handleEndGame(i);break;case r.REQUEST_CODE.BCRHistoryBet:this.baccaratView.popupHistoryBetView.setInfo(i)}},t.prototype.sendJoinRoom=function(){var t=this;p.Windown.UIManager.showLoading();var e=this.sfs.roomManager.getRoomListFromGroup("Baccarat").find(function(t){return cc.log("value"+t.getVariable("cj").value),t.containsVariable("cj")&&t.getVariable("cj").value});e?(this.roomSFS=e,e.isJoined?this.sendGetInfoRoom():(cc.log("nhay vao send join rom: "+e),this.sfs.send(new SFS2X.JoinRoomRequest(e,null,-1)))):setTimeout(function(){t.sendJoinRoom()},3e3)},t.prototype.sendGetInfoRoom=function(){this.sendRequest(r.REQUEST_CODE.TXinfoRoom,l.ConectManager.getIns().getSFSObj())},t.prototype.sendRequest=function(t,e){l.ConectManager.getIns().sendRequest(t,e,this.roomSFS)},t.prototype.sendToServer=function(t,e){this.isCanSendData&&null!=this.roomSFS&&(this.isCanSendData=!1,l.ConectManager.getIns().sendRequest(t,e,this.roomSFS))},t.prototype.sendBet=function(t,e){var i=l.ConectManager.getIns().getSFSObj();i.putLong("bet",e),i.putInt("id",t),this.sendToServer("bet",i)},t.prototype.intiGame=function(){return n(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return[4,p.Windown.loadBundle(c.default.Baccarat.toString())];case 1:return t=e.sent(),p.Windown.UIManager.showLoadingData(),t.preloadScene("Baccarat",{},function(t,e){p.Windown.UIManager.setPerData(t/e)},function(e){e?p.Windown.Dialog.showLog(s.TextDefine.Error):t.loadScene("Baccarat",function(t,e){if(t)return p.Windown.Dialog.showLog(s.TextDefine.Error),void p.Windown.UIManager.hideLoadingData();cc.director.runScene(e,null,function(){p.Windown.UIManager.hideLoadingData()})})}),[2]}})})},t.prototype.onClickBackToLobby=function(){this.roomSFS?l.ConectManager.getIns().sendLeaveRoom(this.roomSFS):cc.director.loadScene("main")},t.prototype.loadPrefabBundle=function(t){return n(this,void 0,void 0,function(){var e;return o(this,function(){return e=cc.assetManager.getBundle(c.default.Baccarat.toString()),[2,new Promise(function(i,n){e.load("Prefab/"+t,function(t,e){if(t)return n(t),null;i(e)})})]})})},t.prototype.sendGetHistoryBet=function(){var t=l.ConectManager.getIns().getSFSObj();this.sendToServer("historyBetBa",t),p.Windown.BaccaratController.isCanSendData=!0},t}();i.default=h,cc._RF.pop()},{"../../../Scritps/DefineTs/EVENT_MANAGER":void 0,"../../../Scritps/DefineTs/REQUEST_CODE":void 0,"../../../Scritps/DefineTs/TextDefine":void 0,"../../../Scritps/Game/GAME_TYPE":void 0,"../../../Scritps/Network/ConectManager":void 0,"../../../Scritps/Windown":void 0}],BaccaratView:[function(t,e,i){"use strict";cc._RF.push(e,"91133cyz0FNj4WIQhDdRhjP","BaccaratView");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,a){function r(t){try{c(n.next(t))}catch(e){a(e)}}function s(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(r,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var i,n,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return c([t,e])}}function c(a){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,n=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(s){a=[6,s],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../../../Scritps/Obs/LbMoneyChange"),l=t("../../../Scritps/Other/MakeDelay"),p=t("../../../Scritps/Util"),h=t("../../../Scritps/Windown"),u=t("./Baccarat.Assets"),d=t("./Baccarat.Audio"),f=t("./Baccarat.ButtonBet"),y=t("./Baccarat.HistoryBet"),B=t("./Baccarat.HistoryMini"),g=t("./Baccarat.MenuView"),v=t("./Baccarat.Player"),b=t("./Baccarat.PopupHistory"),w=cc._decorator,P=w.ccclass,C=w.property,m=cc.Enum({PLAYER:1,TIE:2,BANKER:3,PLAYER_PAIR:4,BANKER_PAIR:5}),S=cc.Enum({PLAYER:1,TIE:2,BANKER:3,PLAYER_PP:14,PLAYER_BP:15,PLAYER_PBP:145,BANKER_PP:34,BANKER_BP:35,BANKER_PBP:345,TIE_PP:24,TIE_BP:25,TIE_PBP:245}),E=cc.Enum({BETTING:1,FINISHED:2,WAITTING:3}),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.players=[],e.thisPlayer=null,e.assets=null,e.menu=null,e.buttonBetController=null,e.historyMini=null,e.popupHistoryBetView=null,e.audio=null,e.nodeGroupUser=null,e.nodeGateBet=[],e.listCardPlayer=[],e.listCardBanker=[],e.nodeGetChip=null,e.lbOtherPlayer=null,e.lbTimer=null,e.lbWaitting=null,e.lbSession=null,e.sprTimer=null,e.lbScoreP=null,e.lbScoreB=null,e.lbTotalBet=null,e.animDealer=null,e.animWinResult=null,e.posPayChipOther=[],e.lbTotalBetB=null,e.lbTotalBetP=null,e.lbTotalBetT=null,e.lbTotalBetBP=null,e.lbTotalBetPP=null,e.listPosChipOnTable=[],e.lbTotalGateBetUser=[],e.effectWinOther=null,e.currentTimer=60,e.totalBetB=0,e.totalBetP=0,e.totalBetBP=0,e.totalBetPP=0,e.totalBetT=0,e.totalBetAllGate=0,e.agUser=0,e.currentBetValue=1e3,e.listTotalBetValue=null,e.listTotalUserBetGate=null,e.listDataPlayerOther=[],e.listLbTotalBet=[],e.gateWin=null,e.gameState=E.BETTING,e.listValueChip=[.1,1,5,10,50,100,500,1e3,2e3,5e3,1e4,5e4,1e5,15e4,2e5],e.lastPlayerInfoData=null,e.makeDelay=null,e.infoCardOnTable_Player=[],e.infoCardOnTable_Banker=[],e.listChipBet=[],e.listChipbetOther=[],e.listBtnBet=[],e.isResetView=!1,e.listGateWin=[],e.HistoryBet=null,e.historyTable=[],e.timeInBg=0,e}return o(e,t),e.prototype.onLoad=function(){var t=this;this.HistoryBet=new y.default,this.nodeGateBet.forEach(function(e){t.listBtnBet.push(e.getComponent(cc.Button))});for(var e=0,i=this.listValueChip.length;e<i;e++)this.listValueChip[e]*=1e3;for(e=0;e<3;e++){var n=this.listCardPlayer[e],o={scaleX:n.scaleX,scaleY:n.scaleY,position:n.position,angle:n.angle,skew:cc.v2(n.skewX,n.skewY)};this.infoCardOnTable_Player.push(o);var a=this.listCardBanker[e],r={scaleX:a.scaleX,scaleY:a.scaleY,position:a.position,angle:a.angle,skew:cc.v2(a.skewX,a.skewY)};this.infoCardOnTable_Banker.push(r)}this.listTotalBetValue=[this.totalBetP,this.totalBetT,this.totalBetB,this.totalBetPP,this.totalBetBP],this.listTotalUserBetGate=[0,0,0,0,0],this.listLbTotalBet=[this.lbTotalBetP,this.lbTotalBetT,this.lbTotalBetB,this.lbTotalBetPP,this.lbTotalBetBP],h.Windown.BaccaratController.baccaratView=this,h.Windown.BaccaratView=this,this.makeDelay=new l.default(this)},e.prototype.start=function(){h.Windown.BaccaratController.sendJoinRoom(),this.audio.playMusic(),null!=h.Windown.BaccaratController.startGameData&&(this.handleStartGame(h.Windown.BaccaratController.startGameData),h.Windown.BaccaratController.startGameData=null),this.setupTimeRunInBg()},e.prototype.getMakeDelay=function(t){return this.makeDelay.getDelay(t)},e.prototype.handlePlayerInfo=function(t){if(this.gameState!=E.FINISHED){this.listDataPlayerOther=[];var e=JSON.parse(h.Windown.SFSArrToJson(t.get("data"))),i=e.find(function(t){return t.id==h.Windown.User.userId});null!=i&&(cc.log("Co this player trong listPlayer, xoa no di"),e.splice(e.indexOf(i),1)),7==e.length&&(this.listDataPlayerOther.push(e.pop()),cc.log("Co 7 player trong listPlayer, xoa 1 thang  di:"+e.length));for(var n=0,o=0,a=e.length;o<a;o++){var r=e[o],s=this.players[n];s==this.thisPlayer&&(s=this.players[n+1],n++),cc.isValid(s)&&s!=this.thisPlayer?(s.node.active=!0,s.resetPlayer(),s.setInfo(r.id,r.nn,r.ag,r.iv),n++):cc.log(" ko du player de hien thi")}this.lbOtherPlayer.string=t.getInt("so")+this.listDataPlayerOther.length+""}else this.lastPlayerInfoData=t},e.prototype.handleRoomInfo=function(t){h.Windown.UIManager.hideLoading(),this.currentTimer=t.getInt("time"),this.sprTimer.fillRange=this.currentTimer/30,this.lbSession.string="#"+t.getInt("sision");var e=t.getBool("isG"),i=JSON.parse(h.Windown.SFSArrToJson(t.get("cur")));if(this.gameState=e?E.BETTING:E.FINISHED,this.historyMini.setInfo(JSON.parse(t.get("his")).reverse()),this.historyTable=JSON.parse(t.get("his")).reverse(),this.setStateBtnGate(this.gameState==E.BETTING),this.gameState==E.BETTING?this.onCountTimeRemain():this.onCountWaitting(),this.gameState==E.BETTING){this.thisPlayer.showButtonBet();for(var n=0;n<i.length;n++){for(var o=i[n],a=o.id,r=o.b,s=0;s<r.length;s++)for(var c=r[s].bet,l=this.getPlayerWithId(r[s].idP),p=this.getListChipValue(c),u=0,d=p.length;u<d;u++){var f=this.assets.getChipBet(p[u]);cc.isValid(l)?(l.listChipBet.push(f),f.playerID=l.id):(this.listChipbetOther.push(f),f.playerID=-1),this.listChipBet.push(f),f.parent=this.nodeGateBet[a-1],f.gate=a,f.value=p[u];var y=a>3?20:30,B=h.Windown.RandomNumber(this.listPosChipOnTable[a-1].x-y,this.listPosChipOnTable[a-1].x+y),g=h.Windown.RandomNumber(this.listPosChipOnTable[a-1].y-y,this.listPosChipOnTable[a-1].y+y);f.setPosition(cc.v2(B,g))}switch(a){case m.BANKER:this.totalBetB=o.t;break;case m.PLAYER:this.totalBetP=o.t;break;case m.BANKER_PAIR:this.totalBetBP=o.t;break;case m.PLAYER_PAIR:this.totalBetPP=o.t;break;case m.TIE:this.totalBetT=o.t}this.lbTotalBetB.setMoney(this.totalBetB,!0),this.lbTotalBetP.setMoney(this.totalBetP,!0),this.lbTotalBetBP.setMoney(this.totalBetBP,!0),this.lbTotalBetPP.setMoney(this.totalBetPP,!0),this.lbTotalBetT.setMoney(this.totalBetT,!0),cc.log("handlePlayerInfoo:listDataPlayerOther size="+this.listDataPlayerOther.length)}}this.thisPlayer.setAvatar(h.Windown.User.avatrId),this.thisPlayer.setName(h.Windown.User.nickName),this.thisPlayer.setChip(h.Windown.User.userAg,!1),this.players.unshift(this.thisPlayer),this.agUser=h.Windown.User.userAg},e.prototype.handleStartGame=function(t){cc.log("handleStartGame"),this.audio.playEffect(this.audio.dealer_startBet),this.setStateBtnGate(!0),this.isResetView=!1,this.lbSession.string="#"+t.getInt("sision"),this.currentTimer=t.getInt("time"),this.lbTimer.string=this.currentTimer+"",this.sprTimer.fillRange=1,this.onCountTimeRemain(),this.setDealerAnim("Start_Bet",!1),this.thisPlayer.showButtonBet()},e.prototype.handlePlayerBet=function(t){var e=t.getInt("pid");this.audio.playEffect(this.audio.throwChip);var i=t.getInt("id"),n=this.getPlayerWithId(e),o=t.getLong("bet");null!=n&&n==this.thisPlayer&&(this.totalBetAllGate+=o,this.listTotalUserBetGate[i-1]+=o,this.lbTotalBet.setMoney(this.totalBetAllGate,!0),this.lbTotalGateBetUser[i-1].string=h.Windown.formatMoney(this.listTotalUserBetGate[i-1]),this.lbTotalGateBetUser[i-1].node.parent.active=!0);for(var a=this.getListChipValue(o),r=0,s=a.length;r<s;r++){var c=this.assets.getChipBet(a[r]);this.listChipBet.push(c);var l=this.nodeGateBet[i-1],p=null;null!=n?(p=l.convertToNodeSpaceAR(n.node.parent.convertToWorldSpaceAR(n.node.position)),n.setChip(t.getLong("ag")),n.listChipBet.push(c),c.playerID=n.id,n.gateBetted.includes(i)||n.gateBetted.push(i)):(p=l.convertToNodeSpaceAR(this.nodeGroupUser.parent.convertToWorldSpaceAR(this.nodeGroupUser.position)),this.listChipbetOther.push(c),c.playerID=-1),c.parent=l,c.gate=i,c.value=a[r],c.setPosition(p);var u=i>3?20:30,d=h.Windown.RandomNumber(this.listPosChipOnTable[i-1].x-u,this.listPosChipOnTable[i-1].x+u),f=h.Windown.RandomNumber(this.listPosChipOnTable[i-1].y-u,this.listPosChipOnTable[i-1].y+u),y=cc.v2(d,f);cc.tween(c).set({position:p}).delay(.05*r).to(.3,{x:y.x,y:y.y},{easing:cc.easing.sineOut}).start()}this.listTotalBetValue[i-1]=t.getLong("ttB"),this.listLbTotalBet[i-1].setMoney(this.listTotalBetValue[i-1],!0)},e.prototype.setStateBtnGate=function(t){this.listBtnBet.forEach(function(e){e.interactable=t})},e.prototype.handleEndGame=function(t){return r(this,void 0,void 0,function(){var e,i,n,o,a,c,l,p,u,d,f,y,B,g,v=this;return s(this,function(b){switch(b.label){case 0:return cc.log("handleEndGame"),this.setStateBtnGate(!1),this.onCountWaitting(),this.gameState=E.FINISHED,this.thisPlayer.hideButtonBet(),this.setDealerAnim("Stop_Bet"),this.audio.playEffect(this.audio.dealer_endBet),e=JSON.parse(t.getUtfString("vP")),i=JSON.parse(t.getUtfString("vD")),this.historyTable=JSON.parse(t.get("his")).reverse(),n=JSON.parse(h.Windown.SFSArrToJson(t.get("d7"))),o=t.getLong("agW"),this.agUser=t.getLong("ag"),a=JSON.parse(h.Windown.SFSArrToJson(t.get("w"))),this.listGateWin=[],a.forEach(function(t){v.listGateWin.push(t.id)}),cc.log("vp====",e),cc.log("vD====",i),c=this.animDealer.findAnimation("Stop_Bet").duration,[4,h.Windown.BaccaratView.getMakeDelay(c+.5).prosime];case 1:return b.sent(),this.setDealerAnim("DealCard"),l=this.getScore(e),p=this.getScore(i),this.gateWin=parseInt(this.listGateWin.toString().split(",").join("")),cc.log("ScoreP:"+l+"==ScoreB\n"+p+"--gateWin:"+this.gateWin),u=this.infoCardOnTable_Player[0],this.listGateWin=[],a.forEach(function(t){v.listGateWin.push(t.id)}),cc.log("vp====",e),cc.log("vD====",i),cc.tween(this.listCardPlayer[0]).set({scaleX:.15,scaleY:.15,angle:-30,x:-95,y:149}).delay(.85).call(function(){v.audio.playEffect(v.audio.flipCard),v.listCardPlayer[0].active=!0,v.listCardPlayer[0].opacity=255}).to(.3,{scaleX:u.scaleX,scaleY:u.scaleY,angle:u.angle,skewX:u.skew.x,skewY:u.skew.y,position:u.position},{easing:cc.easing.sineIn}).start(),d=this.infoCardOnTable_Banker[0],cc.tween(this.listCardBanker[0]).set({scaleX:.15,scaleY:.15,angle:36,x:30,y:133}).delay(2.25).call(function(){v.audio.playEffect(v.audio.flipCard),v.listCardBanker[0].active=!0,v.listCardBanker[0].opacity=255}).to(.3,{scaleX:d.scaleX,scaleY:d.scaleY,angle:d.angle,skewX:d.skew.x,skewY:d.skew.y,position:d.position},{easing:cc.easing.sineIn}).delay(.5).call(function(){v.openCard(v.listCardPlayer[0],e[0].I,u)}).start(),f=this.infoCardOnTable_Player[1],cc.tween(this.listCardPlayer[1]).set({scaleX:.15,scaleY:.15,angle:-36,x:-95,y:149}).delay(3.5).call(function(){v.audio.playEffect(v.audio.flipCard),v.listCardPlayer[1].active=!0,v.listCardPlayer[1].opacity=255}).to(.3,{scaleX:f.scaleX,scaleY:f.scaleY,angle:f.angle,skewX:f.skew.x,skewY:f.skew.y,position:f.position},{easing:cc.easing.sineIn}).delay(.5).call(function(){v.openCard(v.listCardBanker[0],i[0].I,d)}).start(),y=this.infoCardOnTable_Banker[1],cc.tween(this.listCardBanker[1]).set({scaleX:.15,scaleY:.15,angle:36,x:30,y:133}).delay(4.85).call(function(){return r(v,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.audio.playEffect(this.audio.flipCard),this.listCardBanker[1].active=!0,this.listCardBanker[1].opacity=255,[4,this.getMakeDelay(.75).prosime];case 1:return t.sent(),this.showScore(m.PLAYER,e,!0),[2]}})})}).to(.3,{scaleX:y.scaleX,scaleY:y.scaleY,angle:y.angle,skewX:y.skew.x,skewY:y.skew.y,position:y.position},{easing:cc.easing.sineIn}).delay(.5).call(function(){v.openCard(v.listCardPlayer[1],e[1].I,f)}).delay(1).call(function(){return r(v,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.openCard(this.listCardBanker[1],i[1].I,y),[4,this.getMakeDelay(.75).prosime];case 1:return t.sent(),[4,this.showScore(m.BANKER,i,!0)];case 2:return t.sent(),[2]}})})}).start(),[4,this.getMakeDelay(8.25).prosime];case 2:return b.sent(),2!=e.length||2!=i.length?[3,4]:[4,this.getMakeDelay(1.5).prosime];case 3:return b.sent(),[3,8];case 4:return 3!=e.length?[3,6]:(B=this.infoCardOnTable_Player[2],this.setDealerAnim("DealCard_Nan"),cc.tween(this.listCardPlayer[2]).set({scaleX:.15,scaleY:.15,angle:-36,x:-20,y:125}).delay(1.1).call(function(){v.audio.playEffect(v.audio.flipCard),v.listCardPlayer[2].active=!0,v.listCardPlayer[2].opacity=255}).to(.3,{scaleX:B.scaleX,scaleY:B.scaleY,angle:B.angle,skewX:B.skew.x,skewY:B.skew.y,position:B.position},{easing:cc.easing.sineIn}).delay(.5).call(function(){return r(v,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.openCard(this.listCardPlayer[2],e[2].I,B),[4,this.getMakeDelay(1).prosime];case 1:return t.sent(),this.showScore(m.PLAYER,e,!1),[2]}})})}).start(),[4,this.getMakeDelay(2.9).prosime]);case 5:b.sent(),b.label=6;case 6:return 3!=i.length?[3,8]:(g=this.infoCardOnTable_Banker[2],this.setDealerAnim("DealCard_Table_Right"),cc.tween(this.listCardBanker[2]).set({scaleX:.15,scaleY:.15,angle:36,x:30,y:133}).delay(1.1).call(function(){v.audio.playEffect(v.audio.flipCard),v.listCardBanker[2].active=!0,v.listCardBanker[2].opacity=255}).to(.3,{scaleX:g.scaleX,scaleY:g.scaleY,angle:g.angle,skewX:g.skew.x,skewY:g.skew.y,position:g.position},{easing:cc.easing.sineIn}).delay(.5).call(function(){return r(v,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.openCard(this.listCardBanker[2],i[2].I,g),[4,this.getMakeDelay(1).prosime];case 1:return t.sent(),this.showScore(m.BANKER,i,!1),[2]}})})}).start(),[4,this.getMakeDelay(2.9).prosime]);case 7:b.sent(),b.label=8;case 8:return[4,this.showWinResult()];case 9:return b.sent(),this.getAllChipOnTable(),[4,this.getMakeDelay(1.5).prosime];case 10:return b.sent(),this.payChipWinOnTalbe(),[4,this.getMakeDelay(1.5).prosime];case 11:return b.sent(),this.moveChipToPlayer(),[4,this.getMakeDelay(1.5).prosime];case 12:return b.sent(),[4,this.showResultAgWin(n,o)];case 13:return b.sent(),this.resetView(),[2]}})})},e.prototype.getAllChipOnTable=function(){var t=this;cc.log("this.listGateWin="+this.listGateWin),this.audio.playEffect(this.audio.getChip),this.listChipBet.forEach(function(e){if(!t.listGateWin.includes(e.gate)){var i=t.nodeGetChip.parent.convertToWorldSpaceAR(t.nodeGetChip.position),n=e.parent.convertToNodeSpaceAR(i);cc.tween(e).delay(h.Windown.RandomNumber(0,3)/10).to(1.5,{position:n},{easing:cc.easing.quintOut}).to(.1,{opacity:0}).call(function(){t.assets.chipBetPool.put(e);var i=t.getPlayerWithId(e.playerID);null!=i&&i.listChipBet.splice(i.listChipBet.indexOf(e),1),t.listChipbetOther.includes(e)&&t.listChipbetOther.splice(t.listChipbetOther.indexOf(e),1)}).start()}})},e.prototype.payChipWinOnTalbe=function(){for(var t=this,e=!1,i=function(i){var o=n.listGateWin[i];n.players.forEach(function(i){i.listChipBet.forEach(function(n,a){if(n.gate==o){e=!0,n.value=t.getChipWinValueOnGate(n.value,o);for(var r=t.getListChipValue(n.value),s=0,c=r.length;s<c;s++)t.effectChipPay(r[s],o,.07*a,i.listChipPay)}})}),n.listChipbetOther.forEach(function(i,n){if(i.gate==o){e=!0,i.value=t.getChipWinValueOnGate(i.value,o);for(var a=t.getListChipValue(i.value),r=0,s=a.length;r<s;r++)t.effectChipPay(a[r],o,.07*n,t.listChipbetOther)}})},n=this,o=0;o<this.listGateWin.length;o++)i(o);e&&this.audio.playEffect(this.audio.chipMoveToPlayer_turn1)},e.prototype.getChipWinValueOnGate=function(t,e){return e!=m.PLAYER_PAIR&&e!=m.BANKER_PAIR||(t*=15),e==m.TIE&&(t*=9),t},e.prototype.moveChipToPlayer=function(){var t=this,e=cc.find("bg/playerContainer",this.node),i=!1;this.players.forEach(function(n){n.listChipBet.forEach(function(o,a){if(a<7){cc.log("playerBet ="+n.nickname),cc.log("MoveChip:Chip aprrent:",o.parent.name);var r=h.Windown.convertNodeInOtherNode(o,e);o.parent=e,o.setPosition(r),i=!0,cc.tween(o).to(.6,{x:n.posPayChip[0].x,y:n.posPayChip[0].y+5*a,scale:.8*o.scale}).delay(1).to(.3,{position:n.node.position}).call(function(){t.assets.chipBetPool.put(o)}).start()}else cc.log("chip >7"),cc.tween(o).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){t.assets.chipBetPool.put(o),cc.log("player listchipo bet size="+n.listChipBet.length)}).start()}),n.listChipPay.forEach(function(o,a){if(a<7){var r=h.Windown.convertNodeInOtherNode(o,e);o.parent=e,o.setPosition(r),i=!0,cc.tween(o).to(.6,{x:n.posPayChip[1].x,y:n.posPayChip[1].y+5*a,scale:.8*o.scale}).delay(.75).to(.3,{position:n.node.position}).call(function(){t.assets.chipBetPool.put(o)}).start()}else cc.tween(o).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){t.assets.chipBetPool.put(o)}).start()})});var n=0;this.listChipbetOther.forEach(function(o,a){if(a<7){i=!0,n+=o.value,cc.log("Chip Parent="+o.parent.name);var r=h.Windown.convertNodeInOtherNode(o,e);o.parent=e,o.setPosition(r);var s=1==o.isChipPayOther?0:1;cc.tween(o).to(.6,{x:t.posPayChipOther[s].x,y:t.posPayChipOther[s].y+5*a,scale:.8*o.scale}).delay(.75).to(.3,{position:t.nodeGroupUser.position}).call(function(){t.assets.chipBetPool.put(o)}).start()}else n+=o.value,t.assets.chipBetPool.put(o);cc.log("total other win="+n)}),this.listChipbetOther.length>0&&cc.tween(this.node).delay(1.5).call(function(){t.showEffectWinOther(n)}).start(),this.listChipBet.forEach(function(e){cc.isValid(t.getPlayerWithId(e.playerID))||t.listChipbetOther.includes(e)||cc.tween(e).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){t.assets.chipBetPool.put(e)}).start()}),i&&this.audio.playEffect(this.audio.chipMoveToPlayer_turn1)},e.prototype.showEffectWinOther=function(t){var e=this;null==this.effectWinOther?(cc.log("show effectWinOther"),this.effectWinOther=this.assets.getEffectWin(t),this.effectWinOther.parent=this.node,this.effectWinOther.position=this.nodeGroupUser.position):this.effectWinOther.getChildByName("lbChipWin").getComponent(cc.Label).string=h.Windown.formatMoney(t),this.effectWinOther.active=!0;var i=this.effectWinOther.getComponentInChildren(sp.Skeleton);i.setSkin("win"),i.setSlotsToSetupPose(),i.setAnimation(0,"appear",!1),i.setCompleteListener(function(){i.setAnimation(0,"idle",!1),i.setCompleteListener(null)}),this.scheduleOnce(function(){cc.tween(e.effectWinOther).to(.2,{scaleX:0},{easing:cc.easing.backIn}).call(function(){e.effectWinOther.active=!1}).start()},3)},e.prototype.showResultAgWin=function(t,e){return void 0===t&&(t=[]),r(this,void 0,void 0,function(){var i,n,o=this;return s(this,function(a){switch(a.label){case 0:return i=[],n=!1,t.forEach(function(t){var e=t.id,a=o.getPlayerWithId(e);cc.isValid(a)&&t.agw>0&&a!=o.thisPlayer&&(n=!0,i.push(a.showWinEffect(t.agw)),a.setChip(t.ag))}),0!=e&&(i.push(this.thisPlayer.showWinSpineEffect(e)),this.thisPlayer.setChip(this.agUser),this.audio.playEffect(this.audio.youWin)),n&&this.audio.playEffect(this.audio.chipMoveToPlayer_turn2),[4,Promise.all(i)];case 1:return a.sent(),[4,this.getMakeDelay(.25).prosime];case 2:return a.sent(),[2]}})})},e.prototype.endResultAgWin=function(){},e.prototype.resetView=function(){var t=this;if(!this.isResetView){this.isResetView=!0,this.totalBetAllGate=0,this.lbTotalBet.setMoney(0),this.listChipBet.forEach(function(e){t.assets.chipBetPool.put(e)}),this.listChipBet=[],this.listChipbetOther.forEach(function(e){t.assets.chipBetPool.put(e)}),this.listChipbetOther=[],this.totalBetB=this.totalBetP=this.totalBetPP=this.totalBetBP=0,this.listBtnBet.forEach(function(t){t.getComponentInChildren(cc.Animation).node.active=!1}),this.animWinResult.node.active=!1,this.setDealerAnim("DiscardCard");for(var e=function(e){var n=i.listCardPlayer[e],o=i.listCardBanker[e];n.parent.getChildByName("cardBgWin"+(e+1)).active=!1,o.parent.getChildByName("cardBgWin"+(e+1)).active=!1,cc.tween(n).delay(.1*e).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){cc.audioEngine.play(t.audio.flipCard,!1,1),n.getComponent(cc.Sprite).spriteFrame=t.assets.getCardBack(),n.active=!1}).start(),cc.tween(o).delay(.1*e).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){cc.log("Player effect Get Card"),t.audio.playEffect(t.audio.flipCard),o.getComponent(cc.Sprite).spriteFrame=t.assets.getCardBack(),o.active=!1}).start()},i=this,n=0;n<3;n++)e(n);this.lbScoreP.node.active=!1,this.lbScoreB.node.active=!1,this.players.forEach(function(t){t.resetPlayer()}),this.gameState=E.WAITTING,null!=this.lastPlayerInfoData&&(this.handlePlayerInfo(this.lastPlayerInfoData),this.lastPlayerInfoData=null),this.listLbTotalBet.forEach(function(t){t.setMoneyNoTime(0)}),this.lbTotalGateBetUser.forEach(function(e,i){e.node.parent.active=!1,t.HistoryBet.ListGateBet[i]=t.listTotalUserBetGate[i],t.listTotalUserBetGate[i]=0}),this.historyMini.addItemHistory(this.historyTable),cc.log("listTotalUserBetGate=",this.listTotalUserBetGate)}},e.prototype.effectChipPay=function(t,e,i,n,o){void 0===o&&(o=null);var a=this.assets.getChipBet(t);a.isChipPayOther=n==this.listChipbetOther,n.push(a);var r=this.nodeGateBet[e-1];a.parent=r;var s=e>3?20:30,c=h.Windown.RandomNumber(this.listPosChipOnTable[e-1].x-s,this.listPosChipOnTable[e-1].x+s),l=h.Windown.RandomNumber(this.listPosChipOnTable[e-1].y-s,this.listPosChipOnTable[e-1].y+s),p=cc.v2(c,l);i=i<.75?i:.75,a.opacity=0,cc.tween(a).set({x:p.x,y:p.y+50,opacity:0}).delay(i).to(.3,{x:p.x,y:p.y,opacity:255},{easing:cc.easing.sineIn}).call(function(){null!=o&&o()}).start()},e.prototype.showWinResult=function(){return r(this,void 0,void 0,function(){var t=this;return s(this,function(){return[2,new Promise(function(e){return r(t,void 0,void 0,function(){var t,i=this;return s(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.animWinResult.node.active=!0,this.audio.playEffect(this.audio.gateWinEffect),this.getGateWinNormal()==m.TIE?(this.animWinResult.node.x=0,this.animWinResult.setSkin("tie"),this.animWinResult.setSlotsToSetupPose()):(this.animWinResult.node.x=this.getGateWinNormal()==m.PLAYER?-170:170,this.animWinResult.setSkin("win"),this.animWinResult.setSlotsToSetupPose(),this.getGateWinNormal()==m.BANKER?this.listCardBanker.forEach(function(t,e){t.active&&(t.parent.getChildByName("cardBgWin"+(e+1)).active=!0)}):this.listCardPlayer.forEach(function(t,e){t.active&&(t.parent.getChildByName("cardBgWin"+(e+1)).active=!0)})),this.animWinResult.setAnimation(0,"appear",!1),this.animWinResult.setCompleteListener(function(){i.animWinResult.setAnimation(0,"idle",!0)}),this.setDealerAnim(this.getGateWinNormal()==m.TIE?"Win_Draw":this.getGateWinNormal()==m.PLAYER?"Win_Player":"Win_Banker"),this.listGateWin.forEach(function(t){i.listBtnBet[t-1].getComponentInChildren(cc.Animation).node.active=!0}),[4,this.getMakeDelay(1.5).prosime];case 1:return n.sent(),e(null),[3,3];case 2:return t=n.sent(),p.Util.ThrowErrProsime(t),[3,3];case 3:return[2]}})})})]})})},e.prototype.setDealerAnim=function(t,e,i){var n=this;void 0===e&&(e=!1),void 0===i&&(i=null),this.animDealer.setAnimation(0,t,e),this.animDealer.setCompleteListener(null),null!=i?(this.animDealer.setCompleteListener(i),this.animDealer.setCompleteListener(null)):this.animDealer.setCompleteListener(function(){n.animDealer.setAnimation(0,"Idle_Tap",!0)})},e.prototype.showScore=function(t,e,i){cc.log("arrCArd= ",e);var n=i?2:3,o=this.getScore(e,n),a=cc.tween().set({scale:0}).to(.3,{scale:1},{easing:cc.easing.backOut});t==m.PLAYER?(this.lbScoreP.node.active=!0,i?(this.lbScoreP.setMoneyNoTime(o),a.clone(this.lbScoreP.node).start()):this.lbScoreP.setMoney(o)):(this.lbScoreB.node.active=!0,i?(this.lbScoreB.setMoneyNoTime(o),a.clone(this.lbScoreB.node).start()):this.lbScoreB.setMoney(o))},e.prototype.getScore=function(t,e){void 0===e&&(e=2);for(var i=0,n=0;n<e;n++){var o=t[n];i+=o.N>=10?0:o.N}return i%10},e.prototype.openCard=function(t,e,i){var n=this,o=0;o=t.x>0?10:-10,t.x,t.getPosition(),cc.tween(t).to(.55,{scaleX:.01,angle:i.angle+10,skewX:i.skew.x+o},{easing:cc.easing.cubicInOut}).call(function(){t.getComponent(cc.Sprite).spriteFrame=n.assets.getCardSprite(e),n.audio.playEffect(n.audio.openCard)}).to(.2,{scaleX:i.scaleX,angle:i.angle,skewX:i.skew.x},{easing:cc.easing.cubicInOut}).start()},e.prototype.onCountTimeRemain=function(){var t=this;this.lbTimer.node.active=!0,this.lbWaitting.node.active=!1,cc.Tween.stopAllByTarget(this.lbWaitting),this.lbTimer.string=this.currentTimer+"",this.schedule(function(){t.currentTimer>0?(t.lbTimer.string=t.currentTimer+"",t.currentTimer--):t.lbTimer.string="0"},1,this.currentTimer),cc.tween(this.sprTimer).to(this.currentTimer,{fillRange:0}).start()},e.prototype.onCountWaitting=function(){this.lbTimer.node.active=!1,this.lbWaitting.node.active=!0,this.sprTimer.fillRange=0,cc.tween(this.lbWaitting).repeatForever(cc.tween().set({string:""}).delay(.5).set({string:"."}).delay(.5).set({string:".."}).delay(.5).set({string:"..."}).delay(.5)).start()},e.prototype.getPlayerWithId=function(t){return t==h.Windown.User.userId?this.thisPlayer:this.players.find(function(e){return e.id==t})},e.prototype.getListChipValue=function(t){var e=[];return this.getNameChip(t,e),e},e.prototype.getNameChip=function(t,e){for(var i,n,o=0,a=0;a<this.listValueChip.length;a++)if(this.listValueChip[a]>t){o=this.listValueChip[a-1];break}if(0==o)for(a=this.listValueChip.length-1;a>=0;a++)if(t>=this.listValueChip[a]){o=this.listValueChip[a];break}if(i=Math.floor(t/o),t=n=t%o,o>=1e3)for(a=0;a<i;a++)e.push(o);n>0&&this.getNameChip(t,e)},e.prototype.getGateWinNormal=function(){var t=0;switch(this.gateWin){case S.PLAYER:case S.PLAYER_BP:case S.PLAYER_PP:case S.PLAYER_PBP:t=S.PLAYER;break;case S.BANKER:case S.BANKER_BP:case S.BANKER_PP:case S.BANKER_PBP:t=S.BANKER;break;case S.TIE:case S.TIE_BP:case S.TIE_PP:case S.TIE_PBP:t=S.TIE}return t},e.prototype.onClickSendBet=function(t,e){cc.log("onClickSendBet:",e),cc.log("isCandSend="+h.Windown.BaccaratController.isCanSendData),h.Windown.BaccaratController.sendBet(parseInt(e),this.currentBetValue),setTimeout(function(){h.Windown.BaccaratController.isCanSendData=!0},500)},e.prototype.onClickShowMenu=function(){this.audio.playClick(),this.menu.node.active=!0,this.menu.onshow()},e.prototype.setupTimeRunInBg=function(){var t=this;cc.game.on(cc.game.EVENT_HIDE,function(){t.timeInBg=cc.sys.now()}),cc.game.on(cc.game.EVENT_SHOW,function(){var e=cc.sys.now(),i=t.timeInBg;cc.director.getActionManager().update((e-i)/1e3),cc.Tween.stopAllByTag(1),(e-i)/1e3>15&&h.Windown.BaccaratController.onClickBackToLobby()})},a([C([v.default])],e.prototype,"players",void 0),a([C(v.default)],e.prototype,"thisPlayer",void 0),a([C(u.default)],e.prototype,"assets",void 0),a([C(g.default)],e.prototype,"menu",void 0),a([C(f.default)],e.prototype,"buttonBetController",void 0),a([C(B.default)],e.prototype,"historyMini",void 0),a([C(b.default)],e.prototype,"popupHistoryBetView",void 0),a([C(d.default)],e.prototype,"audio",void 0),a([C(cc.Node)],e.prototype,"nodeGroupUser",void 0),a([C([cc.Node])],e.prototype,"nodeGateBet",void 0),a([C([cc.Node])],e.prototype,"listCardPlayer",void 0),a([C([cc.Node])],e.prototype,"listCardBanker",void 0),a([C(cc.Node)],e.prototype,"nodeGetChip",void 0),a([C(cc.Label)],e.prototype,"lbOtherPlayer",void 0),a([C(cc.Label)],e.prototype,"lbTimer",void 0),a([C(cc.Label)],e.prototype,"lbWaitting",void 0),a([C(cc.Label)],e.prototype,"lbSession",void 0),a([C(cc.Sprite)],e.prototype,"sprTimer",void 0),a([C(c.default)],e.prototype,"lbScoreP",void 0),a([C(c.default)],e.prototype,"lbScoreB",void 0),a([C(c.default)],e.prototype,"lbTotalBet",void 0),a([C(sp.Skeleton)],e.prototype,"animDealer",void 0),a([C(sp.Skeleton)],e.prototype,"animWinResult",void 0),a([C([cc.Vec2])],e.prototype,"posPayChipOther",void 0),a([C(c.default)],e.prototype,"lbTotalBetB",void 0),a([C(c.default)],e.prototype,"lbTotalBetP",void 0),a([C(c.default)],e.prototype,"lbTotalBetT",void 0),a([C(c.default)],e.prototype,"lbTotalBetBP",void 0),a([C(c.default)],e.prototype,"lbTotalBetPP",void 0),a([C([cc.Vec2])],e.prototype,"listPosChipOnTable",void 0),a([C([cc.Label])],e.prototype,"lbTotalGateBetUser",void 0),a([P],e)}(cc.Component);i.default=_,cc._RF.pop()},{"../../../Scritps/Obs/LbMoneyChange":void 0,"../../../Scritps/Other/MakeDelay":void 0,"../../../Scritps/Util":void 0,"../../../Scritps/Windown":void 0,"./Baccarat.Assets":"Baccarat.Assets","./Baccarat.Audio":"Baccarat.Audio","./Baccarat.ButtonBet":"Baccarat.ButtonBet","./Baccarat.HistoryBet":"Baccarat.HistoryBet","./Baccarat.HistoryMini":"Baccarat.HistoryMini","./Baccarat.MenuView":"Baccarat.MenuView","./Baccarat.Player":"Baccarat.Player","./Baccarat.PopupHistory":"Baccarat.PopupHistory"}]},{},["Baccarat.Assets","Baccarat.Audio","Baccarat.ButtonBet","Baccarat.ChipBet","Baccarat.HistoryBet","Baccarat.HistoryMini","Baccarat.MenuView","Baccarat.Player","Baccarat.PopupHistory","Baccarat.SettingView","BaccaratController","BaccaratView"]);